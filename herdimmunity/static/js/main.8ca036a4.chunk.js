(this.webpackJsonpinfectious_matter_component=this.webpackJsonpinfectious_matter_component||[]).push([[0],{131:function(e,t,n){var i={name:"matter-collision-events",version:"0.1.5",for:"matter-js@^0.12.0",install:function(e){var t=e.Body.create;e.Body.create=function(){var e=t.apply(null,arguments);return e.onCollide=function(t){e._mceOC=t},e.onCollideEnd=function(t){e._mceOCE=t},e.onCollideActive=function(t){e._mceOCA=t},e},e.after("Engine.create",(function(){e.Events.on(this,"collisionStart",(function(t){t.pairs.map((function(t){e.Events.trigger(t.bodyA,"onCollide",{pair:t}),e.Events.trigger(t.bodyB,"onCollide",{pair:t}),t.bodyA._mceOC&&t.bodyA._mceOC(t),t.bodyB._mceOC&&t.bodyB._mceOC(t)}))})),e.Events.on(this,"collisionActive",(function(t){t.pairs.map((function(t){e.Events.trigger(t.bodyA,"onCollideActive",{pair:t}),e.Events.trigger(t.bodyB,"onCollideActive",{pair:t}),t.bodyA._mceOCA&&t.bodyA._mceOCA(t),t.bodyB._mceOCA&&t.bodyB._mceOCA(t)}))})),e.Events.on(this,"collisionEnd",(function(t){t.pairs.map((function(t){e.Events.trigger(t.bodyA,"onCollideEnd",{pair:t}),e.Events.trigger(t.bodyB,"onCollideEnd",{pair:t}),t.bodyA._mceOCE&&t.bodyA._mceOCE(t),t.bodyB._mceOCE&&t.bodyB._mceOCE(t)}))}))}))}};n(15).Plugin.register(i),e.exports.MatterCollisionEvents=i},135:function(e,t,n){var i=n(41);function a(e,t){return Math.random()*(t-e)+e}function o(e){this.name=e,this.uuid=i(),this.bounds=void 0,this.props={},this.friction=.02,this.occupants=[],this.border_color=void 0}o.prototype.draw_borders=function(e,t){t=t&&this.border_color?t||this.border_color:"black";var n=this.bounds.max.x-this.bounds.min.x,i=this.bounds.max.y-this.bounds.min.y;e.beginPath(),e.rect(this.bounds.min.x-2,this.bounds.min.y-2,n+4,i+4),e.strokeStyle=t,e.lineWidth=2,e.stroke()},o.prototype.get_random_position=function(){return this.bounds?{x:a(this.bounds.min.x,this.bounds.max.x),y:a(this.bounds.min.y,this.bounds.max.y)}:{x:0,y:0}},o.prototype.remove_agent=function(e){this.occupants=this.occupants.filter((function(t){return t!==e})),e.location=void 0},o.prototype.set_bounds=function(e){this.bounds=e},o.prototype.migrate_to=function(e,t,n){this.remove_agent(t),e.add_agent(t),n&&n(t)},o.prototype.try_getting_random_residents=function(e){for(var t,n=[],i=0;i<e;i++){var a=(t=this.occupants)[Math.floor(t.length*Math.random())];a&&0==a.migrating&&n.push(a)}return n},o.prototype.add_agent=function(e){this.occupants.push(e),e.location=this},e.exports=o},136:function(e,t){function n(){this.members=[]}n.prototype.move_cohort=function(e,t){for(var n=0;n<this.members.length;n++){var i=this.members[n];i.location.migrate_to(e,i,t)}},n.prototype.send_cohort_home=function(e){for(var t=0;t<this.members.length;t++){var n=this.members[t];n.location.migrate_to(n.home,n,e)}},n.prototype.add_agent=function(e,t){this.members.push(e),e.cohorts.push(this),t&&t(e)},e.exports=n},137:function(e,t,n){var i=n(138),a=n(73);function o(){this.fast_queue=new i((function(e,t){return e.time<t.time}))}o.prototype.add_event=function(e,t){a(t.time&&t.callback),t.original_time=t.time,t.time+=e,this.fast_queue.add(t)},o.prototype.run_events_fired=function(e,t){for(var n=0;this.fast_queue.peek()&&this.fast_queue.peek().time<e&&n<t;){var i=this.fast_queue.poll();0==i.stale&&(i.recurring&&this.add_event(e,{time:i.original_time,callback:i.callback,recurring:!0,stale:!1}),i.callback(),n+=1)}},o.prototype.clear_events=function(){this.fast_queue=null,this.fast_queue=new i((function(e,t){return e.time<t.time}))},e.exports=o},139:function(e,t,n){var i=n(41);function a(e){this.track_all_contacts=!0,this.state=void 0,this.body=e,this.interaction_callback=void 0,this.uuid=i(),this.viva_color=void 0,this.events=[],this.location=void 0,this.home=void 0,this.cohorts=[],this.color=void 0,this.home_state={},this.migrating=!1,this.masked=!1,this.immunized=!1}a.prototype.add_body=function(e){this.body=e},a.prototype.register_interaction_callback=function(e){this.interaction_callback=e},a.prototype.handle_agent_contact=function(e){this.interaction_callback(e)},a.prototype.draw_mask=function(e,t){e.fillStyle="#FFFFFF",e.strokeStyle="#000000",e.lineWidth=1,e.fillRect(this.body.position.x-t,this.body.position.y,2*t,t-1),e.strokeRect(this.body.position.x-t,this.body.position.y,2*t,t-1),e.stroke()},e.exports=a},154:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(13),r=n.n(o),s=n(16),c=n(182),d=n(184),l=n(186),m=n(185),u=n(187),h=n(194),_=n(189),p=n(188),g=n(180),b=n(193),f=n(35),y=n(48),j=n(28),v=n(41),x=function(e){var t=e.color_float+j.jStat.exponential.sample(8),n=Math.min(e.contagiousness+j.jStat.normal.sample(0,.1),1);t%=1,this.color_float=t,this.contagiousness=n};function O(e,t){this.parent=void 0,this.interaction_callback=void 0,this.uuid=v(),this.color_float=e||Math.random(),this.mutation_function=x,this.contagiousness=.5}O.prototype.get_offspring=function(e){var t=new O(this.color_float);return Math.random()<e&&this.mutation_function&&t.mutation_function(this),t};var k=O,w=n(1),E=n(15),C=(n(53),function(e){var t=e.InfectiousMatterRef,n=e.InfectiousMatterAPI,a=e.redraw_trigger,o=e.setWorldReadyTrigger,r=e.locationImmunity,s=e.popSize,c=Object(i.useRef)(null),d=function(e){var i={type:"residence",friction:.05,immunized_frac:e[0],bounds:{min:{x:10,y:10},max:{x:150,y:150}}},a=E.Common.clone(i);a.bounds.min.x=160,a.bounds.max.x=300,a.immunized_frac=e[1];var o=E.Common.clone(i);o.bounds.min.x=310,o.bounds.max.x=450,o.immunized_frac=e[2];var r=E.Common.clone(i);r.bounds.min.x=460,r.bounds.max.x=600,r.immunized_frac=e[3];var c=E.Common.clone(i);c.bounds.min.x=610,c.bounds.max.x=750,c.immunized_frac=e[4];var d=n(t,{type:"add_location",payload:{residence_props:i}}),l=n(t,{type:"add_location",payload:{residence_props:a}}),m=n(t,{type:"add_location",payload:{residence_props:o}}),u=n(t,{type:"add_location",payload:{residence_props:r}}),h=n(t,{type:"add_location",payload:{residence_props:c}});n(t,{type:"add_agents",payload:{residence:d,num_agents:s/5}}),n(t,{type:"add_agents",payload:{residence:l,num_agents:s/5}}),n(t,{type:"add_agents",payload:{residence:m,num_agents:s/5}}),n(t,{type:"add_agents",payload:{residence:u,num_agents:s/5}}),n(t,{type:"add_agents",payload:{residence:h,num_agents:s/5}}),E.Common.shuffle(t.current.agents)};return Object(i.useEffect)((function(){var e={sim_time_per_day:1e3,agent_size:2,link_lifetime:200};e.link_lifetime=7*e.sim_time_per_day;console.log("initalizing matter"),t.current=new Z(!1,e,{per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:1},{viva_colors:[2846468607,2846468607,2846468607,2846468607,2846468607,2846468607,2846468607],matter_colors:["darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey"]}),n(t,{type:"setup_environment",payload:{sim_div:c}}),d(r)}),[]),Object(i.useLayoutEffect)((function(){t.current&&(d(r),o((function(e){return e+1})))}),[a]),Object(w.jsx)("div",{children:Object(w.jsx)("div",{ref:c,style:{height:160,width:"auto"}})})}),B=n(15);n(130);var N=n(131).MatterCollisionEvents;B.use("matter-wrap",N),B._seed=2,Math.random=B.Common.random,j.jStat._random_fn=B.Common.random;var I=n(73),P=n(53),S=new P.Graph.graph,A=n(135),T=n(136),M=n(137),R=n(139),z=n(140),L=(z({colormap:"chlorophyll",nshades:9,format:"hex",alpha:1}),z({colormap:"portland",nshades:15,format:"hex",alpha:1}),n(142)(["white"])),F={SUSCEPTIBLE:0,INFECTED:1,RECOVERED:2,IMMUNE:3,size:4},W=B.Engine,D=B.Render,q=B.World,H=(B.Body,B.Bodies),U=(B.Bounds,B.Mouse),V=B.MouseConstraint,G=B.Events,J={sim_time_per_day:2e3,agent_size:3,link_lifetime:4e3,pathogen_mut_prob:.1},Y={per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:.2,use_pathogen_contagiousness:!1},K={viva_colors:[2332068863,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["darkmagenta","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]};function Z(e,t,n,i){this.simulation_params=B.Common.extend(J,t),this.infection_params=B.Common.extend(Y,n),this.simulation_colors=B.Common.extend(K,i),this.matter_world=q.create(),this.headless=e||!1,this.pathogen_color_range=L,console.log("creating infectious matter environment!"),this.matter_engine=W.create({positionIterations:15,velocityIterations:15,constraintIterations:10}),this.matter_engine.world.gravity.y=0,this.event_queue=new M,this.migration_graph=new P.Graph.graph}Z.prototype.setup_renderer=function(e){var t=e;this.matter_render=D.create({element:t,engine:this.matter_engine,options:{height:t.offsetHeight,width:t.offsetWidth,background:"rgba(229,229,229)",wireframes:!1}});var n=U.create(this.matter_render.canvas);this.mouseConstraint=V.create(this.matter_engine,{mouse:n,constraint:{stiffness:.1,render:{visible:!0}}}),n.element.removeEventListener("mousewheel",n.mousewheel),n.element.removeEventListener("DOMMouseScroll",n.mousewheel),this.matter_render.mouse=n,q.add(this.matter_engine.world,this.mouseConstraint),D.run(this.matter_render),W.run(this.matter_engine)},Z.prototype.run_headless=function(e){if(e=e||30,this.run_headless)for(var t=0;t<e*this.simulation_params.sim_time_per_day;t++){this.event_queue.run_events_fired(this.cur_sim_time,500);B.Common.choose(this.agents);W.update(this.matter_engine,1e3/60),this.cur_sim_time=this.matter_engine.timing.timestamp}},Z.prototype.setup_matter_env=function(){var e=this;S.clear(),this.locations=[],this.migration_graph.clear(),this.location_uuid_hash={},this.agents=[],this.cohorts=[],this.cur_sim_time=0,this.state_counts=[],this.matter_engine.timing.timestamp=0;for(var t=0;t<F.size;t++)this.state_counts.push(0);this.headless||(G.on(this.matter_render,"beforeRender",(function(t){e.cur_sim_time=t.timestamp,e.event_queue.run_events_fired(e.cur_sim_time,500)})),G.on(this.matter_render,"afterRender",(function(t){var n=e.matter_render.context;if(n)for(var i=0;i<e.locations.length;i++)e.locations[i].draw_borders(n)}))),this.add_event({time:100,callback:this.pulse_orgs_event(),recurring:!0,stale:!1})},Z.prototype.update_org_state=function(e,t){var n=e.agent_object.state;e.agent_object.state=t,"undefined"!==typeof n&&(this.state_counts[n]-=1),this.state_counts[t]+=1,e.render.lineWidth=3;var i=e.render.strokeStyle;switch(t){case F.INFECTED:i="red",e.render.fillStyle="red",4278190335;break;case F.RECOVERED:i="red",e.render.fillStyle=e.agent_object.home_color,4294967295;break;case F.SENSITIVE:i="black",e.render.lineWidth=3;break;case F.IMMUNE:i="grey"}return e.render.strokeStyle=i,e},Z.prototype.add_location=function(e,t){var n=new A(e);return n.border_color=t.border_color,n.set_bounds(t.bounds),n.friction=t.friction,n.type=t.type||"none",n.immunized_frac=t.immunized_frac||0,n.home_color=this.simulation_colors.matter_colors[this.locations.length],n.viva_node_color=this.simulation_colors.viva_colors[this.locations.length],this.locations.push(n),this.location_uuid_hash[n.uuid]=n,n},Z.prototype.add_cohort=function(){var e=new T;return this.cohorts.push(e),e},Z.prototype.assign_cohort=function(e,t){t.add_agent(e.agent_object)},Z.prototype.expose_org=function(e,t,n){var i=this;n&&n.pathogen?e.agent_object.pathogen=n.pathogen.get_offspring(this.simulation_params.pathogen_mut_prob):e.agent_object.pathogen=new k(.5,"root"),this.update_org_state(e,F.INFECTED),this.post_infection_callback&&this.post_infection_callback(e.agent_object,n);var a={time:Math.max(j.jStat.exponential.sample(1/this.infection_params.infectious_period_mu),3)*this.simulation_params.sim_time_per_day,callback:function(){i.update_org_state(e,F.RECOVERED)},stale:!1};this.add_event(a),e.agent_object.events.push(a)},Z.prototype.register_infection_callback=function(e){this.post_infection_callback=e},Z.prototype._check_edge_for_removal=function(e){var t=this;return function(){e.data.timestamp<t.cur_sim_time-t.simulation_params.link_lifetime?S.removeLink(e):t.add_event({time:t.cur_sim_time+t.simulation_params.link_lifetime-e.data.timestamp,callback:t._check_edge_for_removal(e),stale:!1})}},Z.prototype.update_colors=function(e){var t=this;this.simulation_colors=B.Common.extend(this.simulation_colors,e),console.log(this.simulation_colors),this.locations.forEach((function(e,n){e.home_color=t.simulation_colors.matter_colors[n],e.viva_node_color=t.simulation_colors.viva_colors[n]})),this.agents.forEach((function(e){e.home_color=e.location.home_color,e.body.render.fillStyle=e.home_color,t.update_org_state(e.body,e.state)}))},Z.prototype.calc_prob_infection=function(e,t){return this.infection_params.per_contact_infection},Z.prototype._default_interaction_callback=function(e){var t=this;return function(n){n.state==F.INFECTED&&e.agent_object.state==F.SUSCEPTIBLE&&B.Common.random(0,1)<t.calc_prob_infection(e,n.body)&&t.expose_org(e,F.INFECTED,n),I(n.uuid&&e.agent_object.uuid);var i=S.hasLink(e.agent_object.uuid,n.uuid)||S.hasLink(n.uuid,e.agent_object.uuid);i?i.data.timestamp=t.cur_sim_time:(I(S.hasNode(e.agent_object.uuid)&&S.hasNode(e.agent_object.uuid)),i=S.addLink(e.agent_object.uuid,n.uuid,{origin:e.agent_object.uuid,timestamp:t.cur_sim_time}),t.add_event({time:t.simulation_params.link_lifetime+1,callback:t._check_edge_for_removal(i),stale:!1}))}},Z.prototype.add_agent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.SUSCEPTIBLE;I(e&&e.get_random_position);var n=e.get_random_position(),i=H.circle(n.x,n.y,this.simulation_params.agent_size,{plugin:{wrap:e.bounds}});return i.strokeStyle="black",i.lineWidth=2,i.agent_object=new R(i),i.frictionAir=e.friction,i.friction=0,i.restitution=1.1,i.node=S.addNode(i.agent_object.uuid,{something:!0}),i.agent_object.home=e,i.agent_object.color=e.home_color||"black",i.agent_object.viva_color=e.viva_node_color,i.render.fillStyle=i.agent_object.color,e.add_agent(i.agent_object),i.agent_object.register_interaction_callback(this._default_interaction_callback(i,this.get_prob_of_infection)),i.onCollide((function(e){e.bodyA===i&&e.bodyB.agent_object?e.bodyA.agent_object.handle_agent_contact(e.bodyB.agent_object):e.bodyB===i&&e.bodyA.agent_object&&e.bodyB.agent_object.handle_agent_contact(e.bodyA.agent_object)})),q.add(this.matter_engine.world,i),this.agents.push(i.agent_object),this.update_org_state(i,t),i},Z.prototype.delete_agent=function(e){this.agents=this.agents.filter((function(t){return t!==e})),B.Composite.remove(this.matter_engine.world,e.body),S.removeNode(e.uuid),this.state_counts[e.state]-=1,e.events.forEach((function(e){e.stale=!0})),e.location.remove_agent(e)},Z.prototype.add_event=function(e){I(e.time&&e.callback),this.event_queue.add_event(this.cur_sim_time,e)},Z.prototype.set_agent_contact_callback=function(e){this.agent_contact_callback=e},Z.prototype.clear_simulator=function(){q.clear(this.matter_engine.world),W.clear(this.matter_engine),this.event_queue.clear_events()},Z.prototype.remove_simulator=function(){this.clear_simulator(),D.stop(),this.matter_engine.events={},this.matter_render.canvas.remove(),this.matter_render.canvas=null,this.matter_render.context=null,this.matter_render.textures={},this.matter_world=null,this.matter_engine=null,this.event_queue=null,this.matter_render=null,this.mouseConstraint=null},Z.prototype.pulse_orgs_event=function(){var e=this;return function(){if(e.agents.length>0)for(var t=0;t<200;t++){var n=B.Common.choose(e.agents);B.Body.applyForce(n.body,n.body.position,{x:B.Common.random(-2e-5*e.infection_params.movement_scale,2e-5*e.infection_params.movement_scale),y:B.Common.random(-2e-5*e.infection_params.movement_scale,2e-5*e.infection_params.movement_scale)})}}},Z.prototype.get_migration_links=function(){var e=[];return this.migration_graph.forEachLink((function(t){e.push({from_uuid:t.fromId,to_uuid:t.toId,num_agents:t.data.num_agents})})),e},Z.prototype.add_migration_link=function(e,t,n){var i=this.migration_graph.hasLink(e,t);i?i.data.num_agents=n:this.migration_graph.addLink(e,t,{num_agents:n})},Z.prototype.remove_migration_link=function(e,t){var n=this.migration_graph.hasLink(e,t);n&&this.migration_graph.removeLink(n)},Z.prototype.new_migration_event=function(){var e=this;return function(){e.migration_graph.forEachLink((function(t){var n=e.location_uuid_hash[t.fromId],i=e.location_uuid_hash[t.toId];n.try_getting_random_residents(t.data.num_agents).forEach((function(t){t.home_state={location:n,position:Object(y.a)({},t.body.position),velocity:Object(y.a)({},t.body.velocity)},n.migrate_to(i,t,(function(e){e.body.plugin.wrap=i.bounds,B.Body.setPosition(e.body,i.get_random_position()),e.body.frictionAir=i.friction,e.migrating=!0})),e.add_event({time:e.simulation_params.sim_time_per_day,callback:function(){i.migrate_to(n,t,(function(e){B.Body.setPosition(e.body,t.home_state.position),e.body.plugin.wrap=n.bounds,B.Body.setVelocity(e.body,t.home_state.velocity),e.body.frictionAir=n.friction,e.migrating=!1}))}})}))}))}};var Q=n(15),X=n.n(Q),$=n(191),ee=n(190),te=n(192),ne=n(183),ie=Object(g.a)((function(e){return{root:{minWidth:300,minHeight:300},controlls:{width:300},paper:{height:300,width:300,textAlign:"center"},sim_paper:{height:160,width:760,textAlign:"center"},paperControlls:{minHeight:300,minWidth:300,textAlign:"center",padding:e.spacing(1)}}})),ae=function(e){ie();return Object(w.jsxs)(c.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:3,children:[Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(te.a,{src:"static/lz_small.png"})}),Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(f.a,{children:Object(w.jsx)(ne.a,{color:"inherit",href:"https://infectiousmatter.com/index.html#about_me",children:"Luis Zaman"})})}),Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(f.a,{variant:"overline",display:"block",children:e.date})})]})},oe=n(12),re=Object(g.a)((function(e){return{root:{flexGrow:0,minWidth:600,position:"relative"},Typography:{},headingPanel:{marginTop:"50vh"},contentPanel:{marginTop:"40vh",minHeight:"80vh"},subPanel:{marginTop:"10vh",minHeight:"20vh"},introFooter:{marginTop:"10vh"},stickyContent:{marginTop:"2vh",position:"sticky",top:0},topPadding:{marginTop:"15px"},sim_paper:{height:160,width:760,textAlign:"center"}}}));Z.prototype.mask_transmission_props={self_protection:.05,others_protection:.5},Z.prototype.calc_prob_infection=function(e,t){var n=this.infection_params.per_contact_infection;return e.agent_object.masked&&t.agent_object.masked?n*(1-this.mask_transmission_props.self_protection)*(1-this.mask_transmission_props.others_protection):e.agent_object.masked&&!t.agent_object.masked?n*(1-this.mask_transmission_props.self_protection):!e.agent_object.masked&&t.agent_object.masked?n*(1-this.mask_transmission_props.others_protection):e.agent_object.masked||t.agent_object.masked?void 0:n};var se=function e(t,n){if("setup_environment"==n.type&&(t.current.setup_renderer(n.payload.sim_div.current),t.current.setup_matter_env()),"update_infection_params"==n.type&&(n.payload.per_contact_infection&&(t.current.infection_params.per_contact_infection=n.payload.per_contact_infection),n.payload.infectious_period_mu&&(t.current.infection_params.infectious_period_mu=n.payload.infectious_period_mu)),"update_mask_transmission_params"==n.type&&(n.payload.self_protection&&(t.current.mask_transmission_props.self_protection=n.payload.self_protection),n.payload.others_protection&&(t.current.mask_transmission_props.others_protection=n.payload.others_protection)),"update_movement_scale"==n.type&&n.payload.movement_scale&&(t.current.infection_params.movement_scale=n.payload.movement_scale),"reset_simulator"==n.type&&(t.current.clear_simulator(),t.current.setup_matter_env()),"add_location"==n.type)return t.current.add_location("residence",n.payload.residence_props);if("add_random_agent"==n.type){var i=X.a.Common.choose(t.current.locations),a=t.current.add_agent(i);X.a.Common.random(0,1)<i.immunized_frac&&t.current.update_org_state(a,F.IMMUNE),n.payload&&n.payload.callback&&a&&n.payload.callback(a.agent_object)}if("remove_random_agent"==n.type){var o=X.a.Common.choose(t.current.agents);t.current.delete_agent(o)}if("add_agents"==n.type){var r=null;if(n.payload.residence&&n.payload.num_agents)for(var s=0;s<n.payload.num_agents;s++)r=t.current.add_agent(n.payload.residence),X.a.Common.random(0,1)<n.payload.residence.immunized_frac&&t.current.update_org_state(r,F.IMMUNE);n.payload.callback&&r&&n.payload.callback(r.agent_object)}if("map_agents"==n.type)return t.current.agents.map((function(e,t){return n.payload.callback(e,t)}));if("forEach_agents"==n.type&&t.current.agents.forEach((function(e){return n.payload.callback(e)})),"map_locations"==n.type)return t.current.locations.map((function(e,t){return n.payload.callback(e,t)}));if("forEach_location"==n.type&&t.current.locations.forEach((function(e){return n.payload.callback(e)})),"infect_random_agents"==n.type&&n.payload.num_agents)for(var c=0;c<n.payload.num_agents;c++){var d=X.a.Common.choose(t.current.agents);t.current.expose_org(d.body,F.INFECTED)}if("infect_random_agent_everywhere"==n.type&&n.payload.num_agents&&t.current.locations.forEach((function(e){for(var i=e.try_getting_random_residents(2*n.payload.num_agents),a=0;a<n.payload.num_agents;a++)t.current.expose_org(i[a].body,F.INFECTED)})),"get_migration_links"==n.type)return t.current.get_migration_links();if("add_migration_link"==n.type&&t.current.add_migration_link(n.payload.from_location,n.payload.to_location,n.payload.num_agents),"clear_migration_links"==n.type&&t.current.migration_graph.clear(),"remove_migration_link"==n.type&&t.current.remove_migration_link(n.payload.from_location,n.payload.to_location),"get_state_counts"==n.type)return{state_counts:t.current.state_counts,cur_time:t.current.cur_sim_time/t.current.simulation_params.sim_time_per_day};if("set_num_mask"==n.type){var l=[],m=[];t.current.agents.forEach((function(e){e.masked?l.push(e):m.push(e)}));var u=l.length,h=n.payload.num_masked-u;if(h>0)for(var _=0;_<h;_++)m[_].masked=!0;else if(h<0)for(var p=0;p<-h;p++)l[p].masked=!1}if("set_pop_size"==n.type){var g=n.payload.pop_size-t.current.agents.length;if(g>0)for(var b=0;b<g;b++)e(t,{type:"add_random_agent"});else if(g<0)for(var f=0;f<-g;f++)e(t,{type:"remove_random_agent"})}},ce=function(e){var t=re(),n=Object(i.useRef)(null),a=Object(i.useState)([.1,.3,.5,.7,.9]),o=Object(s.a)(a,2),r=o[0],g=o[1],y=Object(i.useState)(600),j=Object(s.a)(y,2),v=j[0],x=(j[1],Object(i.useState)(2)),O=Object(s.a)(x,2),k=O[0],E=O[1],B=Object(i.useState)(0),N=Object(s.a)(B,2),I=N[0],P=N[1],S=Object(i.useState)(0),A=Object(s.a)(S,2),T=(A[0],A[1]),M=Object(i.useState)(!1),R=Object(s.a)(M,2),z=(R[0],R[1]),L=Object(i.useState)(!1),F=Object(s.a)(L,2),W=(F[0],F[1]),D=Object(i.useState)(!1),q=Object(s.a)(D,2),H=q[0],U=q[1],V=function(e){g(e),se(n,{type:"reset_simulator"}),P((function(e){return e+1}))},G=function(e){V([.1,.3,.5,.7,.9])},J=function(e){se(n,{type:"infect_random_agent_everywhere",payload:{num_agents:e}})};return Object(i.useEffect)((function(){se(n,{type:"update_movement_scale",payload:{movement_scale:k}})}),[k]),Object(i.useEffect)((function(){se(n,{type:"set_pop_size",payload:{pop_size:v}}),T((function(e){return e+1}))}),[v]),Object(w.jsxs)("div",{className:"App",children:[Object(w.jsxs)(oe.a,{offset:.45,onStepEnter:function(e){e.element;var t=e.data;"up"!=e.direction&&(console.log(t),1==t&&z(!0),2==t&&W(!0),"show_sim"==t&&U(!0),"infect_agents"==t&&J(1),"infect_3_agents"==t&&(V([.5,.5,.5,.5,.5]),E(1.5),J(3)),"movement_reinfect"==t&&(G(),E(4)),"single_immunity"==t&&(V([.5,.5,.5,.5,.5]),E(1.5)))},debug:!0,children:[Object(w.jsx)(oe.b,{data:1,children:Object(w.jsxs)(d.a,{className:t.headingPanel,children:[Object(w.jsx)(f.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Our Race Towards Herd Immunity"}),Object(w.jsx)(ae,{date:"April 11th, 2021"}),Object(w.jsx)(m.a,{in:!0,children:Object(w.jsxs)(d.a,{className:t.subPanel,children:[Object(w.jsxs)(f.a,{variant:"h5",gutterBottom:!0,children:["A year ago, I built ",Object(w.jsx)(ne.a,{color:"inherit",href:"https://infectiousmatter.com",children:"InfectiousMatter"})," to help folks gain an intuition for disease transmission dynamics without having to wait and learn from our own mistakes. A year later, we've all unfortunately learned more than expected."]}),Object(w.jsx)(ne.a,{color:"inherit",href:"https://infectiousmatter.com",children:Object(w.jsx)("img",{src:"static/teaser.png",height:"200"})})]})})]})},1),Object(w.jsx)(oe.b,{data:2,children:Object(w.jsxs)(d.a,{children:[Object(w.jsx)(d.a,{className:t.subPanel,children:Object(w.jsxs)(f.a,{variant:"h5",gutterBottom:!0,className:t.subPanel,children:["Now we have multiple vaccines being administered around the world at (all things considered) incredible speeds. We're truely racing towards ",Object(w.jsx)("i",{children:"herd immunity"}),". But how fast we get there and how many lives are saved along the way depend on the decisions we collectively make in the next few months."]})}),Object(w.jsx)(d.a,{className:t.subPanel,children:Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,className:t.subPanels,children:"Throughout the pandemic, limiting transmission has been critical to avoiding overwhelming our healthcare systems. While that is still the true, we have even more to gain (or to lose) by making hard choices in our final push towards a return to normalcy."})})]})},2),Object(w.jsx)(oe.b,{data:123,children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{className:t.subPanel,children:[Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,children:"What is herd immunity anyway?"}),Object(w.jsxs)(f.a,{variant:"body1",gutterBottom:!0,children:["Roughly speaking, it's the level of immunity that will prevent a new epidemic from spreading through the susceptible individuals in a population. The amount of immunity needed depends on many details of the pathogen and the population. For SARS-CoV-2, we likely need between 70% and 80% of people vaccinated or otherwise immune. There was a ",Object(w.jsx)(ne.a,{href:"https://www.npr.org/sections/health-shots/2021/02/18/967462483/how-herd-immunity-works-and-what-stands-in-its-way",children:"really neat interactive"})," on NPR that goes into more detail about what herd immunity is, and how it's affected by the more transmissible variants now circulating."]}),Object(w.jsx)(f.a,{variant:"h6",gutterBottom:!0,children:"However, our extreme focus on immunization is missing a major part of the challenge we're facing."}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,children:"Don't get me wrong, vaccination absolutely deserves the attention and effort it's getting right now. But it isn't our only hurdle left. With a large increase in infections here in Michigan and around the world, our ability to control disease spread just by reaching herd immunity levels is not looking good."})]})})},123),Object(w.jsx)(oe.b,{data:"show_sim",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{className:t.subPanel,children:[Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,children:"Building an Intuition for Herd Immunity"}),Object(w.jsxs)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:["Let's use this interactive epidemic simulator to build our intuition for what herd immunity is, and what it isn't. As you scroll, you'll see a simulation appear where lots of grey balls are bouncing around in boxes. These bouncing balls represent individuals, and each box represents a different independent community. If you missed the ",Object(w.jsx)(ne.a,{href:"https://infectiousmatter.com",children:"original walk-through for InfectiousMatter"}),", definitely check it out for a longer introduction to this kind of model of disease dynamics!"]}),Object(w.jsxs)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:["You might notice that there are different borders on some of the bouncing balls. The dark border indicates ",Object(w.jsx)("b",{children:"Susceptible"})," individuals, while the lighter border depicts ",Object(w.jsx)("b",{children:"Immune"})," individuals."]}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"The level of immunity in a particular community (i.e., box) is increasing as you move from the left (at 10% immune) to the far right (90% immunity)."})]})})}),Object(w.jsx)(oe.b,{data:3,children:Object(w.jsx)(d.a,{className:t.stickyContent,children:Object(w.jsx)(c.a,{container:!0,direction:"row",justify:"center",className:t.root,spacing:3,children:Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(l.a,{in:H,children:Object(w.jsx)(b.a,{className:t.sim_paper,children:Object(w.jsx)(C,{InfectiousMatterRef:n,InfectiousMatterAPI:se,redraw_trigger:I,setWorldReadyTrigger:T,locationImmunity:r,popSize:v})})})})})})},3),Object(w.jsx)(oe.b,{data:"infect_agents",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{className:t.subPanel,children:[Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,children:"Introducing a Single Infection"}),Object(w.jsxs)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:["As you keep scrolling, you'll see a single individual turn red in each of the communities. This is an ",Object(w.jsx)("b",{children:"Infected"})," agent that is capable of spreading infection to other susceptible individuals. When infected agents recover, they retain a red border so you can easily see how big the epidemic was in each community."]}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"This simulation is running live in your browser window, and randomness means each time you visit the page something slightly different will happen. Hopefully you could see that the pathogen doesn't really take hold in communities with high levels of immunity."}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"At the end of this walk-through, you'll have a chance to re-run this simulation and manipulate some parameters to get a feeling for how they affect the pathogen spread!"}),Object(w.jsx)(f.a,{variant:"h6",gutterBottom:!0,className:t.topPadding,children:"TODO: Add screenshots of many trials?"})]})})},4),Object(w.jsx)(oe.b,{data:"movement_reinfect",children:Object(w.jsx)(d.a,{className:t.headingPanel,children:Object(w.jsxs)(d.a,{children:[Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,children:"Relaxed Social Distancing"}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"Pandemic burnout is real. And if you mix that with the nice weather, increasingly accessible vaccines, and easing restrictions, it's easy to imagine people also starting to relax their own cautious behaviors."})]})})},5),Object(w.jsx)(oe.b,{data:"infect_agents",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{children:[Object(w.jsxs)(f.a,{variant:"h5",gutterBottom:!0,className:t.topPadding,children:[Object(w.jsx)("br",{}),"Now let's see what happens when the same single infected agent does in our more active populations."]}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"You probably noticed that more individuals ended up infected, and the pathogen might have spread in communities that were previously protected."}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"That's because increasing interactions also increases the level of immunity required to protect a community."}),Object(w.jsx)(f.a,{variant:"h6",gutterBottom:!0,className:t.topPadding,children:"TODO: Add screenshots of many trials?"})]})})},12),Object(w.jsx)(oe.b,{data:"single_immunity",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{className:t.headingPanel,children:[Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,className:t.topPadding,children:"Focusing on Intermediate Immunity"}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"Let's slow things down again, and set the level of immunity to be 50% in every community. I'm doing this so you can see how random chance plays a critical role in whether or not a large outbreak occurs when infections are introduced. Keep scrolling to"})]})})},6),Object(w.jsx)(oe.b,{data:"infect_agents",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{className:t.topPadding,children:[Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"Scrolling here to infect a single agent in each population again, you'll hopefully see that some communities remain almost entirely untouched while others have large outbreaks."}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"Remember that each community has the same amount of immunity, so the differences between outbreaks is entirely driven by chance!"}),Object(w.jsx)("div",{className:t.subPanel,children:Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,children:"This is precisely when small changes in behavior can have HUGE effects on the severity of an outbreak."})})]})})},17),Object(w.jsx)(oe.b,{data:"infect_3_agents",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{children:[Object(w.jsx)(f.a,{variant:"h5",gutterBottom:!0,className:t.topPadding,children:"For Example"}),Object(w.jsx)(f.a,{variant:"body1",gutterBottom:!0,className:t.topPadding,children:"Even a slight increase in the number of infections that are introduced to communities can shift the balance towards larger outbreaks."})]})})},8),Object(w.jsx)(oe.b,{data:"something",children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(d.a,{children:[Object(w.jsx)(f.a,{children:"Just going from 1 to 3 infected individuals, the outbreaks are substantially larger!"}),Object(w.jsx)(f.a,{variant:"h6",gutterBottom:!0,className:t.topPadding,children:"TODO: Add screenshots of many trials? (both with 1 and with 3)"})]})})},7)]}),Object(w.jsx)(d.a,{className:t.contentPanel,children:Object(w.jsx)(d.a,{children:Object(w.jsx)(f.a,{variant:"h4",gutterBottom:!0,children:"Instead of relaxing in the final stretch, we should try to be extra cautious. Small changes can make huge differences."})})}),Object(w.jsx)(d.a,{children:Object(w.jsx)(d.a,{children:Object(w.jsxs)(c.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:t.root,spacing:10,children:[Object(w.jsx)(f.a,{variant:"h6",gutterBottom:!0,children:"Here are some controls you can play with to keep building your intuition about herd immunity."}),Object(w.jsx)(c.a,{item:!0,alignItems:"flex-start",children:Object(w.jsx)(b.a,{className:t.paper,children:Object(w.jsxs)(u.a,{children:[Object(w.jsx)(p.a,{disableSticky:!0,children:"World Settings"}),Object(w.jsxs)(h.a,{children:[Object(w.jsx)(_.a,{id:"Movement",primary:"Movement Scale"}),Object(w.jsx)($.a,{value:k,"aria-labelledby":"discrete-slider",valueLabelDisplay:"on",onChange:function(e,t){E(t)},step:.25,min:0,max:10})]}),Object(w.jsx)(p.a,{disableSticky:!0,children:"Immunity Actions"}),Object(w.jsx)(h.a,{children:Object(w.jsxs)(c.a,{container:!0,direction:"row",spacing:3,children:[Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(ee.a,{variant:"contained",onClick:function(){G()},children:"Reset Gradient"})}),Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(ee.a,{variant:"contained",onClick:function(){V([.5,.5,.5,.5,.5])},children:"Reset 50%"})}),Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(ee.a,{variant:"contained",onClick:function(){V([.7,.7,.7,.7,.7])},children:"Reset 70%"})})]})}),Object(w.jsx)(p.a,{disableSticky:!0,children:"Infection Actions"}),Object(w.jsx)(h.a,{children:Object(w.jsxs)(c.a,{container:!0,direction:"row",spacing:3,children:[Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(ee.a,{variant:"contained",onClick:function(){J(1)},children:"Infect 1"})}),Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(ee.a,{variant:"contained",onClick:function(){J(2)},children:"Infect 2"})}),Object(w.jsx)(c.a,{item:!0,children:Object(w.jsx)(ee.a,{variant:"contained",onClick:function(){J(3)},children:"Infect 3"})})]})})]})})})]})})}),Object(w.jsx)(d.a,{className:t.subPanel})]})};r.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(ce,{})}),document.getElementById("root"))}},[[154,1,2]]]);
//# sourceMappingURL=main.8ca036a4.chunk.js.map