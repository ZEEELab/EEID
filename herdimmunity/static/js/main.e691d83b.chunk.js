(this.webpackJsonpinfectious_matter_component=this.webpackJsonpinfectious_matter_component||[]).push([[0],{118:function(t,e,n){var o={name:"matter-collision-events",version:"0.1.5",for:"matter-js@^0.12.0",install:function(t){var e=t.Body.create;t.Body.create=function(){var t=e.apply(null,arguments);return t.onCollide=function(e){t._mceOC=e},t.onCollideEnd=function(e){t._mceOCE=e},t.onCollideActive=function(e){t._mceOCA=e},t},t.after("Engine.create",(function(){t.Events.on(this,"collisionStart",(function(e){e.pairs.map((function(e){t.Events.trigger(e.bodyA,"onCollide",{pair:e}),t.Events.trigger(e.bodyB,"onCollide",{pair:e}),e.bodyA._mceOC&&e.bodyA._mceOC(e),e.bodyB._mceOC&&e.bodyB._mceOC(e)}))})),t.Events.on(this,"collisionActive",(function(e){e.pairs.map((function(e){t.Events.trigger(e.bodyA,"onCollideActive",{pair:e}),t.Events.trigger(e.bodyB,"onCollideActive",{pair:e}),e.bodyA._mceOCA&&e.bodyA._mceOCA(e),e.bodyB._mceOCA&&e.bodyB._mceOCA(e)}))})),t.Events.on(this,"collisionEnd",(function(e){e.pairs.map((function(e){t.Events.trigger(e.bodyA,"onCollideEnd",{pair:e}),t.Events.trigger(e.bodyB,"onCollideEnd",{pair:e}),e.bodyA._mceOCE&&e.bodyA._mceOCE(e),e.bodyB._mceOCE&&e.bodyB._mceOCE(e)}))}))}))}};n(12).Plugin.register(o),t.exports.MatterCollisionEvents=o},122:function(t,e,n){var o=n(31);function i(t,e){return Math.random()*(e-t)+t}function a(t){this.name=t,this.uuid=o(),this.bounds=void 0,this.props={},this.friction=.02,this.occupants=[],this.border_color=void 0}a.prototype.draw_borders=function(t,e){e=e&&this.border_color?e||this.border_color:"black";var n=this.bounds.max.x-this.bounds.min.x,o=this.bounds.max.y-this.bounds.min.y;t.beginPath(),t.rect(this.bounds.min.x-2,this.bounds.min.y-2,n+4,o+4),t.strokeStyle=e,t.lineWidth=2,t.stroke()},a.prototype.get_random_position=function(){return this.bounds?{x:i(this.bounds.min.x,this.bounds.max.x),y:i(this.bounds.min.y,this.bounds.max.y)}:{x:0,y:0}},a.prototype.remove_agent=function(t){this.occupants=this.occupants.filter((function(e){return e!==t})),t.location=void 0},a.prototype.set_bounds=function(t){this.bounds=t},a.prototype.migrate_to=function(t,e,n){this.remove_agent(e),t.add_agent(e),n&&n(e)},a.prototype.try_getting_random_residents=function(t){for(var e,n=[],o=0;o<t;o++){var i=(e=this.occupants)[Math.floor(e.length*Math.random())];i&&0==i.migrating&&n.push(i)}return n},a.prototype.add_agent=function(t){this.occupants.push(t),t.location=this},t.exports=a},123:function(t,e){function n(){this.members=[]}n.prototype.move_cohort=function(t,e){for(var n=0;n<this.members.length;n++){var o=this.members[n];o.location.migrate_to(t,o,e)}},n.prototype.send_cohort_home=function(t){for(var e=0;e<this.members.length;e++){var n=this.members[e];n.location.migrate_to(n.home,n,t)}},n.prototype.add_agent=function(t,e){this.members.push(t),t.cohorts.push(this),e&&e(t)},t.exports=n},124:function(t,e,n){var o=n(125),i=n(64);function a(){this.fast_queue=new o((function(t,e){return t.time<e.time}))}a.prototype.add_event=function(t,e){i(e.time&&e.callback),e.original_time=e.time,e.time+=t,this.fast_queue.add(e)},a.prototype.run_events_fired=function(t,e){for(var n=0;this.fast_queue.peek()&&this.fast_queue.peek().time<t&&n<e;){var o=this.fast_queue.poll();0==o.stale&&(o.recurring&&this.add_event(t,{time:o.original_time,callback:o.callback,recurring:!0,stale:!1}),o.callback(),n+=1)}},a.prototype.clear_events=function(){this.fast_queue=null,this.fast_queue=new o((function(t,e){return t.time<e.time}))},t.exports=a},126:function(t,e,n){var o=n(31);function i(t){this.track_all_contacts=!0,this.state=void 0,this.body=t,this.interaction_callback=void 0,this.uuid=o(),this.viva_color=void 0,this.events=[],this.location=void 0,this.home=void 0,this.cohorts=[],this.color=void 0,this.home_state={},this.migrating=!1,this.masked=!1,this.immunized=!1}i.prototype.add_body=function(t){this.body=t},i.prototype.register_interaction_callback=function(t){this.interaction_callback=t},i.prototype.handle_agent_contact=function(t){this.interaction_callback(t)},i.prototype.draw_mask=function(t,e){t.fillStyle="#FFFFFF",t.strokeStyle="#000000",t.lineWidth=1,t.fillRect(this.body.position.x-e,this.body.position.y,2*e,e-1),t.strokeRect(this.body.position.x-e,this.body.position.y,2*e,e-1),t.stroke()},t.exports=i},141:function(t,e,n){"use strict";n.r(e);var o=n(0),i=n.n(o),a=n(13),r=n.n(a),s=n(11),c=n(164),_=n(166),m=n(167),l=n(162),d=n(169),u=n(165),p=n(39),h=n(18),f=n(31),g=function(t){var e=t.color_float+h.jStat.exponential.sample(8),n=Math.min(t.contagiousness+h.jStat.normal.sample(0,.1),1);e%=1,this.color_float=e,this.contagiousness=n};function b(t,e){this.parent=void 0,this.interaction_callback=void 0,this.uuid=f(),this.color_float=t||Math.random(),this.mutation_function=g,this.contagiousness=.5}b.prototype.get_offspring=function(t){var e=new b(this.color_float);return Math.random()<t&&this.mutation_function&&e.mutation_function(this),e};var y=b,v=n(2),j=n(12),k=(n(44),function(t){var e=t.InfectiousMatterRef,n=t.InfectiousMatterAPI,i=t.redraw_trigger,a=t.setWorldReadyTrigger,r=(t.numMasked,t.locationImmunity),s=t.popSize,c=Object(o.useRef)(null),_=function(t){var o={type:"residence",friction:.05,immunized_frac:t[0],bounds:{min:{x:10,y:10},max:{x:150,y:150}}},i=j.Common.clone(o);i.bounds.min.x=160,i.bounds.max.x=300,i.immunized_frac=t[1];var a=j.Common.clone(o);a.bounds.min.x=310,a.bounds.max.x=450,a.immunized_frac=t[2];var r=j.Common.clone(o);r.bounds.min.x=460,r.bounds.max.x=600,r.immunized_frac=t[3];var c=j.Common.clone(o);c.bounds.min.x=610,c.bounds.max.x=750,c.immunized_frac=t[4];var _=n(e,{type:"add_location",payload:{residence_props:o}}),m=n(e,{type:"add_location",payload:{residence_props:i}}),l=n(e,{type:"add_location",payload:{residence_props:a}}),d=n(e,{type:"add_location",payload:{residence_props:r}}),u=n(e,{type:"add_location",payload:{residence_props:c}});n(e,{type:"add_agents",payload:{residence:_,num_agents:s/5}}),n(e,{type:"add_agents",payload:{residence:m,num_agents:s/5}}),n(e,{type:"add_agents",payload:{residence:l,num_agents:s/5}}),n(e,{type:"add_agents",payload:{residence:d,num_agents:s/5}}),n(e,{type:"add_agents",payload:{residence:u,num_agents:s/5}}),j.Common.shuffle(e.current.agents)};return Object(o.useEffect)((function(){var t={sim_time_per_day:1e3,agent_size:2,link_lifetime:200};t.link_lifetime=7*t.sim_time_per_day;console.log("initalizing matter"),e.current=new V(!1,t,{per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:1},{viva_colors:[2846468607,2846468607,2846468607,2846468607,2846468607,2846468607,2846468607],matter_colors:["darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey","darkgrey"]}),n(e,{type:"setup_environment",payload:{sim_div:c}}),_(r)}),[]),Object(o.useLayoutEffect)((function(){e.current&&(_(r),a((function(t){return t+1})))}),[i]),Object(v.jsx)("div",{children:Object(v.jsx)("div",{ref:c,style:{height:160,width:"auto"}})})}),O=n(12);n(117);var x=n(118).MatterCollisionEvents;O.use("matter-wrap",x),O._seed=2,Math.random=O.Common.random,h.jStat._random_fn=O.Common.random;var E=n(64),w=n(44),C=new w.Graph.graph,S=n(122),A=n(123),I=n(124),N=n(126),B=n(127),M=(B({colormap:"chlorophyll",nshades:9,format:"hex",alpha:1}),B({colormap:"portland",nshades:15,format:"hex",alpha:1}),n(129)(["white"])),T={SUSCEPTIBLE:0,INFECTED:1,RECOVERED:2,IMMUNE:3,size:4},P=O.Engine,z=O.Render,R=O.World,F=(O.Body,O.Bodies),L=(O.Bounds,O.Mouse),D=O.MouseConstraint,q=O.Events,W={sim_time_per_day:2e3,agent_size:3,link_lifetime:4e3,pathogen_mut_prob:.1},H={per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:.2,use_pathogen_contagiousness:!1},U={viva_colors:[2332068863,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["darkmagenta","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]};function V(t,e,n,o){this.simulation_params=O.Common.extend(W,e),this.infection_params=O.Common.extend(H,n),this.simulation_colors=O.Common.extend(U,o),this.matter_world=R.create(),this.headless=t||!1,this.pathogen_color_range=M,console.log("creating infectious matter environment!"),this.matter_engine=P.create({positionIterations:15,velocityIterations:15,constraintIterations:10}),this.matter_engine.world.gravity.y=0,this.event_queue=new I,this.migration_graph=new w.Graph.graph}V.prototype.setup_renderer=function(t){var e=t;this.matter_render=z.create({element:e,engine:this.matter_engine,options:{height:e.offsetHeight,width:e.offsetWidth,background:"rgba(229,229,229)",wireframes:!1}});var n=L.create(this.matter_render.canvas);this.mouseConstraint=D.create(this.matter_engine,{mouse:n,constraint:{stiffness:.1,render:{visible:!0}}}),n.element.removeEventListener("mousewheel",n.mousewheel),n.element.removeEventListener("DOMMouseScroll",n.mousewheel),this.matter_render.mouse=n,R.add(this.matter_engine.world,this.mouseConstraint),z.run(this.matter_render),P.run(this.matter_engine)},V.prototype.run_headless=function(t){if(t=t||30,this.run_headless)for(var e=0;e<t*this.simulation_params.sim_time_per_day;e++){this.event_queue.run_events_fired(this.cur_sim_time,500);O.Common.choose(this.agents);P.update(this.matter_engine,1e3/60),this.cur_sim_time=this.matter_engine.timing.timestamp}},V.prototype.setup_matter_env=function(){var t=this;C.clear(),this.locations=[],this.migration_graph.clear(),this.location_uuid_hash={},this.agents=[],this.cohorts=[],this.cur_sim_time=0,this.state_counts=[],this.matter_engine.timing.timestamp=0;for(var e=0;e<T.size;e++)this.state_counts.push(0);this.headless||(q.on(this.matter_render,"beforeRender",(function(e){t.cur_sim_time=e.timestamp,t.event_queue.run_events_fired(t.cur_sim_time,500)})),q.on(this.matter_render,"afterRender",(function(e){var n=t.matter_render.context;if(n)for(var o=0;o<t.locations.length;o++)t.locations[o].draw_borders(n)}))),this.add_event({time:100,callback:this.pulse_orgs_event(),recurring:!0,stale:!1})},V.prototype.update_org_state=function(t,e){var n=t.agent_object.state;t.agent_object.state=e,"undefined"!==typeof n&&(this.state_counts[n]-=1),this.state_counts[e]+=1,t.render.lineWidth=3;var o=t.render.strokeStyle;switch(e){case T.INFECTED:o="red",t.render.fillStyle="red",4278190335;break;case T.RECOVERED:o="red",t.render.fillStyle=t.agent_object.home_color,4294967295;break;case T.SENSITIVE:o="black",t.render.lineWidth=3;break;case T.IMMUNE:o="grey"}return t.render.strokeStyle=o,t},V.prototype.add_location=function(t,e){var n=new S(t);return n.border_color=e.border_color,n.set_bounds(e.bounds),n.friction=e.friction,n.type=e.type||"none",n.immunized_frac=e.immunized_frac||0,n.home_color=this.simulation_colors.matter_colors[this.locations.length],n.viva_node_color=this.simulation_colors.viva_colors[this.locations.length],this.locations.push(n),this.location_uuid_hash[n.uuid]=n,n},V.prototype.add_cohort=function(){var t=new A;return this.cohorts.push(t),t},V.prototype.assign_cohort=function(t,e){e.add_agent(t.agent_object)},V.prototype.expose_org=function(t,e,n){var o=this;n&&n.pathogen?t.agent_object.pathogen=n.pathogen.get_offspring(this.simulation_params.pathogen_mut_prob):t.agent_object.pathogen=new y(.5,"root"),this.update_org_state(t,T.INFECTED),this.post_infection_callback&&this.post_infection_callback(t.agent_object,n);var i={time:Math.max(h.jStat.exponential.sample(1/this.infection_params.infectious_period_mu),3)*this.simulation_params.sim_time_per_day,callback:function(){o.update_org_state(t,T.RECOVERED)},stale:!1};this.add_event(i),t.agent_object.events.push(i)},V.prototype.register_infection_callback=function(t){this.post_infection_callback=t},V.prototype._check_edge_for_removal=function(t){var e=this;return function(){t.data.timestamp<e.cur_sim_time-e.simulation_params.link_lifetime?C.removeLink(t):e.add_event({time:e.cur_sim_time+e.simulation_params.link_lifetime-t.data.timestamp,callback:e._check_edge_for_removal(t),stale:!1})}},V.prototype.update_colors=function(t){var e=this;this.simulation_colors=O.Common.extend(this.simulation_colors,t),console.log(this.simulation_colors),this.locations.forEach((function(t,n){t.home_color=e.simulation_colors.matter_colors[n],t.viva_node_color=e.simulation_colors.viva_colors[n]})),this.agents.forEach((function(t){t.home_color=t.location.home_color,t.body.render.fillStyle=t.home_color,e.update_org_state(t.body,t.state)}))},V.prototype.calc_prob_infection=function(t,e){return this.infection_params.per_contact_infection},V.prototype._default_interaction_callback=function(t){var e=this;return function(n){n.state==T.INFECTED&&t.agent_object.state==T.SUSCEPTIBLE&&O.Common.random(0,1)<e.calc_prob_infection(t,n.body)&&e.expose_org(t,T.INFECTED,n),E(n.uuid&&t.agent_object.uuid);var o=C.hasLink(t.agent_object.uuid,n.uuid)||C.hasLink(n.uuid,t.agent_object.uuid);o?o.data.timestamp=e.cur_sim_time:(E(C.hasNode(t.agent_object.uuid)&&C.hasNode(t.agent_object.uuid)),o=C.addLink(t.agent_object.uuid,n.uuid,{origin:t.agent_object.uuid,timestamp:e.cur_sim_time}),e.add_event({time:e.simulation_params.link_lifetime+1,callback:e._check_edge_for_removal(o),stale:!1}))}},V.prototype.add_agent=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T.SUSCEPTIBLE;E(t&&t.get_random_position);var n=t.get_random_position(),o=F.circle(n.x,n.y,this.simulation_params.agent_size,{plugin:{wrap:t.bounds}});return o.strokeStyle="black",o.lineWidth=2,o.agent_object=new N(o),o.frictionAir=t.friction,o.friction=0,o.restitution=1.1,o.node=C.addNode(o.agent_object.uuid,{something:!0}),o.agent_object.home=t,o.agent_object.color=t.home_color||"black",o.agent_object.viva_color=t.viva_node_color,o.render.fillStyle=o.agent_object.color,t.add_agent(o.agent_object),o.agent_object.register_interaction_callback(this._default_interaction_callback(o,this.get_prob_of_infection)),o.onCollide((function(t){t.bodyA===o&&t.bodyB.agent_object?t.bodyA.agent_object.handle_agent_contact(t.bodyB.agent_object):t.bodyB===o&&t.bodyA.agent_object&&t.bodyB.agent_object.handle_agent_contact(t.bodyA.agent_object)})),R.add(this.matter_engine.world,o),this.agents.push(o.agent_object),this.update_org_state(o,e),o},V.prototype.delete_agent=function(t){this.agents=this.agents.filter((function(e){return e!==t})),O.Composite.remove(this.matter_engine.world,t.body),C.removeNode(t.uuid),this.state_counts[t.state]-=1,t.events.forEach((function(t){t.stale=!0})),t.location.remove_agent(t)},V.prototype.add_event=function(t){E(t.time&&t.callback),this.event_queue.add_event(this.cur_sim_time,t)},V.prototype.set_agent_contact_callback=function(t){this.agent_contact_callback=t},V.prototype.clear_simulator=function(){R.clear(this.matter_engine.world),P.clear(this.matter_engine),this.event_queue.clear_events()},V.prototype.remove_simulator=function(){this.clear_simulator(),z.stop(),this.matter_engine.events={},this.matter_render.canvas.remove(),this.matter_render.canvas=null,this.matter_render.context=null,this.matter_render.textures={},this.matter_world=null,this.matter_engine=null,this.event_queue=null,this.matter_render=null,this.mouseConstraint=null},V.prototype.pulse_orgs_event=function(){var t=this;return function(){if(t.agents.length>0)for(var e=0;e<200;e++){var n=O.Common.choose(t.agents);O.Body.applyForce(n.body,n.body.position,{x:O.Common.random(-2e-5*t.infection_params.movement_scale,2e-5*t.infection_params.movement_scale),y:O.Common.random(-2e-5*t.infection_params.movement_scale,2e-5*t.infection_params.movement_scale)})}}},V.prototype.get_migration_links=function(){var t=[];return this.migration_graph.forEachLink((function(e){t.push({from_uuid:e.fromId,to_uuid:e.toId,num_agents:e.data.num_agents})})),t},V.prototype.add_migration_link=function(t,e,n){var o=this.migration_graph.hasLink(t,e);o?o.data.num_agents=n:this.migration_graph.addLink(t,e,{num_agents:n})},V.prototype.remove_migration_link=function(t,e){var n=this.migration_graph.hasLink(t,e);n&&this.migration_graph.removeLink(n)},V.prototype.new_migration_event=function(){var t=this;return function(){t.migration_graph.forEachLink((function(e){var n=t.location_uuid_hash[e.fromId],o=t.location_uuid_hash[e.toId];n.try_getting_random_residents(e.data.num_agents).forEach((function(e){e.home_state={location:n,position:Object(p.a)({},e.body.position),velocity:Object(p.a)({},e.body.velocity)},n.migrate_to(o,e,(function(t){t.body.plugin.wrap=o.bounds,O.Body.setPosition(t.body,o.get_random_position()),t.body.frictionAir=o.friction,t.migrating=!0})),t.add_event({time:t.simulation_params.sim_time_per_day,callback:function(){o.migrate_to(n,e,(function(t){O.Body.setPosition(t.body,e.home_state.position),t.body.plugin.wrap=n.bounds,O.Body.setVelocity(t.body,e.home_state.velocity),t.body.frictionAir=n.friction,t.migrating=!1}))}})}))}))}};var G=n(12),J=n.n(G),Z=n(168),K=n(170),Q=Object(l.a)((function(t){return{root:{minWidth:300,minHeight:300},controlls:{width:300},paper:{height:300,width:300,textAlign:"center"},sim_paper:{height:160,width:760,textAlign:"center"},paperControlls:{minHeight:300,minWidth:300,textAlign:"center",padding:t.spacing(1)}}})),X=function(t){Q();return Object(v.jsxs)(c.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:3,children:[Object(v.jsx)(c.a,{item:!0,children:Object(v.jsx)(Z.a,{src:"/static/lz_small.png"})}),Object(v.jsx)(c.a,{item:!0,children:Object(v.jsx)(u.a,{children:Object(v.jsx)(K.a,{color:"inherit",href:"https://infectiousmatter.com/index.html#about_me",children:"Luis Zaman"})})}),Object(v.jsx)(c.a,{item:!0,children:Object(v.jsx)(u.a,{variant:"overline",display:"block",children:t.date})})]})},Y=n(9),$=Object(l.a)((function(t){return{root:{flexGrow:0,minWidth:800,position:"relative"},headingPanel:{height:"100vh",minHeight:"200px",marginTop:"50vh"},contentPanel:{height:"100vh",minHeight:"200px"},subPanel:{height:"20vh",minHeight:300},introFooter:{marginTop:"10vh"},stickyContent:{position:"sticky",top:0},sim_paper:{height:160,width:760,textAlign:"center"}}}));V.prototype.mask_transmission_props={self_protection:.05,others_protection:.5},V.prototype.calc_prob_infection=function(t,e){var n=this.infection_params.per_contact_infection;return t.agent_object.masked&&e.agent_object.masked?n*(1-this.mask_transmission_props.self_protection)*(1-this.mask_transmission_props.others_protection):t.agent_object.masked&&!e.agent_object.masked?n*(1-this.mask_transmission_props.self_protection):!t.agent_object.masked&&e.agent_object.masked?n*(1-this.mask_transmission_props.others_protection):t.agent_object.masked||e.agent_object.masked?void 0:n};var tt=function t(e,n){if("setup_environment"==n.type&&(e.current.setup_renderer(n.payload.sim_div.current),e.current.setup_matter_env()),"update_infection_params"==n.type&&(n.payload.per_contact_infection&&(e.current.infection_params.per_contact_infection=n.payload.per_contact_infection),n.payload.infectious_period_mu&&(e.current.infection_params.infectious_period_mu=n.payload.infectious_period_mu)),"update_mask_transmission_params"==n.type&&(n.payload.self_protection&&(e.current.mask_transmission_props.self_protection=n.payload.self_protection),n.payload.others_protection&&(e.current.mask_transmission_props.others_protection=n.payload.others_protection)),"update_movement_scale"==n.type&&n.payload.movement_scale&&(e.current.infection_params.movement_scale=n.payload.movement_scale),"reset_simulator"==n.type&&(e.current.clear_simulator(),e.current.setup_matter_env()),"add_location"==n.type)return e.current.add_location("residence",n.payload.residence_props);if("add_random_agent"==n.type){var o=J.a.Common.choose(e.current.locations),i=e.current.add_agent(o);J.a.Common.random(0,1)<o.immunized_frac&&e.current.update_org_state(i,T.IMMUNE),n.payload&&n.payload.callback&&i&&n.payload.callback(i.agent_object)}if("remove_random_agent"==n.type){var a=J.a.Common.choose(e.current.agents);e.current.delete_agent(a)}if("add_agents"==n.type){var r=null;if(n.payload.residence&&n.payload.num_agents)for(var s=0;s<n.payload.num_agents;s++)r=e.current.add_agent(n.payload.residence),J.a.Common.random(0,1)<n.payload.residence.immunized_frac&&e.current.update_org_state(r,T.IMMUNE);n.payload.callback&&r&&n.payload.callback(r.agent_object)}if("map_agents"==n.type)return e.current.agents.map((function(t,e){return n.payload.callback(t,e)}));if("forEach_agents"==n.type&&e.current.agents.forEach((function(t){return n.payload.callback(t)})),"map_locations"==n.type)return e.current.locations.map((function(t,e){return n.payload.callback(t,e)}));if("forEach_location"==n.type&&e.current.locations.forEach((function(t){return n.payload.callback(t)})),"infect_random_agents"==n.type&&n.payload.num_agents)for(var c=0;c<n.payload.num_agents;c++){var _=J.a.Common.choose(e.current.agents);e.current.expose_org(_.body,T.INFECTED)}if("infect_random_agent_everywhere"==n.type&&n.payload.num_agents&&e.current.locations.forEach((function(t){for(var o=t.try_getting_random_residents(2*n.payload.num_agents),i=0;i<n.payload.num_agents;i++)e.current.expose_org(o[i].body,T.INFECTED)})),"get_migration_links"==n.type)return e.current.get_migration_links();if("add_migration_link"==n.type&&e.current.add_migration_link(n.payload.from_location,n.payload.to_location,n.payload.num_agents),"clear_migration_links"==n.type&&e.current.migration_graph.clear(),"remove_migration_link"==n.type&&e.current.remove_migration_link(n.payload.from_location,n.payload.to_location),"get_state_counts"==n.type)return{state_counts:e.current.state_counts,cur_time:e.current.cur_sim_time/e.current.simulation_params.sim_time_per_day};if("set_num_mask"==n.type){var m=[],l=[];e.current.agents.forEach((function(t){t.masked?m.push(t):l.push(t)}));var d=m.length,u=n.payload.num_masked-d;if(u>0)for(var p=0;p<u;p++)l[p].masked=!0;else if(u<0)for(var h=0;h<-u;h++)m[h].masked=!1}if("set_pop_size"==n.type){var f=n.payload.pop_size-e.current.agents.length;if(f>0)for(var g=0;g<f;g++)t(e,{type:"add_random_agent"});else if(f<0)for(var b=0;b<-f;b++)t(e,{type:"remove_random_agent"})}},et=function(t){var e=$(),n=Object(o.useRef)(null),i=Object(o.useState)([.1,.3,.5,.7,.9]),a=Object(s.a)(i,2),r=a[0],l=a[1],p=Object(o.useState)(0),h=Object(s.a)(p,2),f=h[0],g=(h[1],Object(o.useState)(600)),b=Object(s.a)(g,2),y=b[0],j=(b[1],Object(o.useState)(.05)),O=Object(s.a)(j,2),x=O[0],E=(O[1],Object(o.useState)(.5)),w=Object(s.a)(E,2),C=w[0],S=(w[1],Object(o.useState)(2)),A=Object(s.a)(S,2),I=A[0],N=A[1],B=Object(o.useState)(.5),M=Object(s.a)(B,2),T=M[0],P=(M[1],Object(o.useState)(5)),z=Object(s.a)(P,2),R=z[0],F=(z[1],Object(o.useState)(0)),L=Object(s.a)(F,2),D=L[0],q=L[1],W=Object(o.useState)(0),H=Object(s.a)(W,2),U=(H[0],H[1]),V=function(t){tt(n,{type:"infect_random_agent_everywhere",payload:{num_agents:t}})};return Object(o.useEffect)((function(){tt(n,{type:"update_infection_params",payload:{per_contact_infection:T}})}),[T]),Object(o.useEffect)((function(){tt(n,{type:"update_infection_params",payload:{infectious_period_mu:R}})}),[R]),Object(o.useEffect)((function(){tt(n,{type:"update_mask_transmission_params",payload:{self_protection:x}})}),[x]),Object(o.useEffect)((function(){tt(n,{type:"update_mask_transmission_params",payload:{others_protection:C}})}),[C]),Object(o.useEffect)((function(){tt(n,{type:"update_movement_scale",payload:{movement_scale:I}})}),[I]),Object(o.useEffect)((function(){tt(n,{type:"set_num_mask",payload:{num_masked:f}})}),[f]),Object(o.useEffect)((function(){tt(n,{type:"set_pop_size",payload:{pop_size:y}}),U((function(t){return t+1}))}),[y]),Object(v.jsx)("div",{className:"App",children:Object(v.jsxs)(Y.a,{onStepEnter:function(t){t.element;var e=t.data;t.direction;"infect_agents"==e&&V(1),"infect_3_agents"==e&&V(3),"movement_reinfect"==e&&(l([.1,.3,.5,.7,.9]),tt(n,{type:"reset_simulator"}),q((function(t){return t+1})),N(4)),"single_immunity"==e&&(l([.5,.5,.5,.5,.5]),tt(n,{type:"reset_simulator"}),q((function(t){return t+1})),N(1.5))},debug:!0,children:[Object(v.jsx)(Y.b,{data:1,children:Object(v.jsxs)(_.a,{className:e.headingPanel,children:[Object(v.jsx)(u.a,{variant:"h2",component:"h2",gutterBottom:!0,children:"Our Race Towards Herd Immunity"}),Object(v.jsx)(X,{date:"April 11th, 2021"}),Object(v.jsx)(_.a,{className:e.introFooter,children:Object(v.jsx)(m.a,{in:!0,children:Object(v.jsx)(u.a,{variant:"h5",gutterBottom:!0,children:"A year ago, I built InfectiousMatter to help folks gain an intuition for disease transmission dynamics without having to wait and learn from our own mistakes. A year later, we've all unfortunately learned more than expected."})})})]})},1),Object(v.jsx)(Y.b,{data:2,children:Object(v.jsxs)(_.a,{className:e.contentPanel,children:[Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsxs)(u.a,{variant:"h5",gutterBottom:!0,className:e.contentPanel,children:["Now we have multiple vaccines being administered around the world at (all things considered) incredible speeds. We're truely racing towards ",Object(v.jsx)("i",{children:"herd immunity"}),". But how fast we get there and how many lives are saved along the way depend on the decisions we collectively make in the next few months."]})}),Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{variant:"h5",gutterBottom:!0,className:e.contentPanel,children:"At the start of (and throughout) the pandemic, limiting transmission has been critical to avoiding overwhelming our healthcare systems. Of course that is still the case, but now we have even more to gain (or to lose) by making hard choices in our final push towards a return to normalcy."})})]})},2),Object(v.jsx)(Y.b,{data:3,children:Object(v.jsx)(_.a,{className:e.stickyContent,children:Object(v.jsx)(c.a,{container:!0,direction:"row",justify:"center",className:e.root,spacing:3,children:Object(v.jsx)(c.a,{item:!0,children:Object(v.jsx)(d.a,{className:e.sim_paper,children:Object(v.jsx)(k,{InfectiousMatterRef:n,InfectiousMatterAPI:tt,redraw_trigger:D,setWorldReadyTrigger:U,numMasked:f,locationImmunity:r,popSize:y})})})})})},3),Object(v.jsx)(Y.b,{data:"infect_agents",children:Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{children:"TODO Trigger 1: Automatically infect someone in each location"})})},4),Object(v.jsx)(Y.b,{data:"movement_reinfect",children:Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{children:"TODO Trigger 2: Show how increasing agent movement increases spread across the board"})})},5),Object(v.jsx)(Y.b,{data:"infect_agents",children:Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{children:"and infect..."})})},12),Object(v.jsx)(Y.b,{data:"single_immunity",children:Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{children:"TODO Trigger 3: Focus on one level of immunity (say, 50%?) -- show how it's a stochastic process"})})},6),Object(v.jsx)(Y.b,{data:"infect_agents",children:Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{children:"trigger infecton --"})})},7),Object(v.jsx)(Y.b,{data:"single_immunity",children:Object(v.jsx)(_.a,{className:e.subPanel,children:Object(v.jsx)(u.a,{children:"TODO Trigger 3: show how increasing number of infections increases probability of epidemic, even with higher levels of immunity"})})},8),Object(v.jsx)(Y.b,{data:"infect_3_agents",children:Object(v.jsx)(_.a,{className:e.contentPanel,children:Object(v.jsx)(u.a,{children:"TODO Trigger 3: show how increasing number of infections increases probability of epidemic, even with higher levels of immunity"})})},7)]})})};r.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(et,{})}),document.getElementById("root"))}},[[141,1,2]]]);
//# sourceMappingURL=main.e691d83b.chunk.js.map