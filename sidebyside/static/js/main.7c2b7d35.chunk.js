(this.webpackJsonpinfectious_matter_component=this.webpackJsonpinfectious_matter_component||[]).push([[0],{331:function(t,e,n){var o=n(236);function i(t){this.track_all_contacts=!0,this.state=void 0,this.body=t,this.interaction_callback=void 0,this.uuid=o(),this.viva_color=void 0,this.location=void 0,this.home=void 0,this.cohorts=[],this.color=void 0,this.home_state={},this.migrating=!1,this.masked=!1}i.prototype.add_body=function(t){this.body=t},i.prototype.register_interaction_callback=function(t){this.interaction_callback=t},i.prototype.handle_agent_contact=function(t){this.interaction_callback(t)},i.prototype.draw_mask=function(t,e){t.fillStyle="#FFFFFF",t.strokeStyle="#000000",t.lineWidth=1,t.fillRect(this.body.position.x-.5*e,this.body.position.y-2-e,1*e,e-1),t.strokeRect(this.body.position.x-.5*e,this.body.position.y-2-e,1*e,e-1),t.stroke()},t.exports=i},426:function(t,e,n){var o={name:"matter-collision-events",version:"0.1.5",for:"matter-js@^0.12.0",install:function(t){var e=t.Body.create;t.Body.create=function(){var t=e.apply(null,arguments);return t.onCollide=function(e){t._mceOC=e},t.onCollideEnd=function(e){t._mceOCE=e},t.onCollideActive=function(e){t._mceOCA=e},t},t.after("Engine.create",(function(){t.Events.on(this,"collisionStart",(function(e){e.pairs.map((function(e){t.Events.trigger(e.bodyA,"onCollide",{pair:e}),t.Events.trigger(e.bodyB,"onCollide",{pair:e}),e.bodyA._mceOC&&e.bodyA._mceOC(e),e.bodyB._mceOC&&e.bodyB._mceOC(e)}))})),t.Events.on(this,"collisionActive",(function(e){e.pairs.map((function(e){t.Events.trigger(e.bodyA,"onCollideActive",{pair:e}),t.Events.trigger(e.bodyB,"onCollideActive",{pair:e}),e.bodyA._mceOCA&&e.bodyA._mceOCA(e),e.bodyB._mceOCA&&e.bodyB._mceOCA(e)}))})),t.Events.on(this,"collisionEnd",(function(e){e.pairs.map((function(e){t.Events.trigger(e.bodyA,"onCollideEnd",{pair:e}),t.Events.trigger(e.bodyB,"onCollideEnd",{pair:e}),e.bodyA._mceOCE&&e.bodyA._mceOCE(e),e.bodyB._mceOCE&&e.bodyB._mceOCE(e)}))}))}))}};n(108).Plugin.register(o),t.exports.MatterCollisionEvents=o},430:function(t,e,n){var o=n(236);function i(t,e){return Math.random()*(e-t)+t}function a(t){this.name=t,this.uuid=o(),this.bounds=void 0,this.friction=.2,this.occupants=[],this.border_color=void 0}a.prototype.draw_borders=function(t,e){e=e&&this.border_color?e||this.border_color:"black";var n=this.bounds.max.x-this.bounds.min.x,o=this.bounds.max.y-this.bounds.min.y;t.beginPath(),t.rect(this.bounds.min.x-2,this.bounds.min.y-2,n+4,o+4),t.strokeStyle=e,t.lineWidth=2,t.stroke()},a.prototype.get_random_position=function(){return this.bounds?{x:i(this.bounds.min.x,this.bounds.max.x),y:i(this.bounds.min.y,this.bounds.max.y)}:{x:0,y:0}},a.prototype.remove_agent=function(t){this.occupants=this.occupants.filter((function(e){return e!==t})),t.location=void 0},a.prototype.set_bounds=function(t){this.bounds=t},a.prototype.migrate_to=function(t,e,n){this.remove_agent(e),t.add_agent(e),n&&n(e)},a.prototype.try_getting_random_residents=function(t){for(var e,n=[],o=0;o<t;o++){var i=(e=this.occupants)[Math.floor(e.length*Math.random())];i&&0==i.migrating&&n.push(i)}return n},a.prototype.add_agent=function(t){this.occupants.push(t),t.location=this},t.exports=a},431:function(t,e){function n(){this.members=[]}n.prototype.move_cohort=function(t,e){for(var n=0;n<this.members.length;n++){var o=this.members[n];o.location.migrate_to(t,o,e)}},n.prototype.send_cohort_home=function(t){for(var e=0;e<this.members.length;e++){var n=this.members[e];n.location.migrate_to(n.home,n,t)}},n.prototype.add_agent=function(t,e){this.members.push(t),t.cohorts.push(this),e&&e(t)},t.exports=n},432:function(t,e,n){var o=n(433),i=n(330);function a(){this.fast_queue=new o((function(t,e){return t.time<e.time}))}a.prototype.add_event=function(t,e){i(e.time&&e.callback),e.original_time=e.time,e.time+=t,this.fast_queue.add(e)},a.prototype.run_events_fired=function(t,e){for(var n=0;this.fast_queue.peek()&&this.fast_queue.peek().time<t&&n<e;){var o=this.fast_queue.poll();o.recurring&&this.add_event(t,{time:o.original_time,callback:o.callback,recurring:!0}),o.callback(),n+=1}},a.prototype.clear_events=function(){this.fast_queue=null,this.fast_queue=new o((function(t,e){return t.time<e.time}))},t.exports=a},509:function(t,e,n){"use strict";n.r(e);var o=n(0),i=n.n(o),a=n(14),r=n.n(a),s=n(36),c=n(351),m=n(537),u=n(350),l=n(540),d=n(83),_=n(97),p=n(236),h=function(t){var e=t.color_float+_.jStat.exponential.sample(8),n=t.contagiousness;e%=1,this.color_float=e,this.contagiousness=n};function g(t,e,n){console.log("new pathogen: ",n),this.parent=void 0,this.interaction_callback=void 0,this.uuid=p(),this.color_float=t||Math.random(),this.mutation_function=h,this.contagiousness=n||.5}g.prototype.get_offspring=function(t){var e=new g(this.color_float,this,this.contagiousness);return Math.random()<t&&this.mutation_function&&e.mutation_function(this),e};var f=g,y=n(18),b=n(108),A=(n(111),function(t){var e=t.InfectiousMatterRef,n=t.InfectiousMatterAPI,i=t.redraw_trigger,a=t.setWorldReadyTrigger,r=t.numMasked,s=Object(o.useRef)(null),c=function(t){var o=n(e,{type:"add_location",payload:{residence_props:{type:"residence",friction:.01,bounds:{min:{x:20,y:20},max:{x:380,y:380}}}}}),i=n(e,{type:"add_location",payload:{residence_props:{type:"residence",friction:.01,bounds:{min:{x:410,y:20},max:{x:780,y:380}}}}});n(e,{type:"add_agents",payload:{residence:o,num_agents:150}}),n(e,{type:"add_agents",payload:{residence:i,num_agents:150}}),b.Common.shuffle(e.current.agents),n(e,{type:"set_num_mask",payload:{num_masked:t}}),console.log(t)};return Object(o.useEffect)((function(){var t={sim_time_per_day:1e3,agent_size:4,link_lifetime:200};t.link_lifetime=7*t.sim_time_per_day;console.log("initalizing matter"),e.current=new Z(!1,t,{per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:2,use_pathogen_contagiousness:!0},{viva_colors:[2473647103,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["mediumpurple","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]}),n(e,{type:"setup_environment",payload:{sim_div:s}}),c(r)}),[]),Object(o.useLayoutEffect)((function(){e.current&&(c(r),a((function(t){return t+1})))}),[i]),Object(y.jsx)("div",{children:Object(y.jsx)("div",{ref:s,style:{height:400,width:800}})})}),v="data:image/png;base64,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",k="data:image/png;base64,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",E=n(108);n(425);var j=n(426).MatterCollisionEvents;E.use("matter-wrap",j),E._seed=2,Math.random=E.Common.random,_.jStat._random_fn=E.Common.random;var C=n(330),O=n(111),x=new O.Graph.graph,I=n(430),w=n(431),M=n(432),Q=n(331),B=n(434),Y=(B({colormap:"chlorophyll",nshades:9,format:"hex",alpha:1}),B({colormap:"portland",nshades:15,format:"hex",alpha:1}),n(436)(["white"])),F={SUSCEPTIBLE:0,EXPOSED:1,A_INFECTED:2,S_INFECTED:3,RECOVERED:4,size:5},G=E.Engine,R=E.Render,S=E.World,W=(E.Body,E.Bodies),D=(E.Bounds,E.Mouse),q=E.MouseConstraint,K=E.Events,N=(R=E.Render,{sim_time_per_day:2e3,agent_size:3,link_lifetime:4e3,pathogen_mut_prob:.1}),V={per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:.2,use_pathogen_contagiousness:!0},L={viva_colors:[2332068863,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["darkmagenta","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]};function Z(t,e,n,o){this.simulation_params=E.Common.extend(N,e),this.infection_params=E.Common.extend(V,n),this.simulation_colors=E.Common.extend(L,o),this.matter_world=S.create(),this.headless=t||!1,this.pathogen_color_range=Y,console.log("creating infectious matter environment!"),this.matter_engine=G.create({positionIterations:15,velocityIterations:15,constraintIterations:10}),this.matter_engine.world.gravity.y=0,this.event_queue=new M,this.migration_graph=new O.Graph.graph}Z.prototype.setup_renderer=function(t){var e=t;this.matter_render=R.create({element:e,engine:this.matter_engine,options:{height:e.offsetHeight,width:e.offsetWidth,background:"rgba(229,229,229)",wireframes:!1}});var n=D.create(this.matter_render.canvas);this.mouseConstraint=q.create(this.matter_engine,{mouse:n,constraint:{stiffness:.1,render:{visible:!0}}}),n.element.removeEventListener("mousewheel",n.mousewheel),n.element.removeEventListener("DOMMouseScroll",n.mousewheel),this.matter_render.mouse=n,S.add(this.matter_engine.world,this.mouseConstraint),R.run(this.matter_render),G.run(this.matter_engine)},Z.prototype.run_headless=function(t){if(t=t||30,this.run_headless)for(var e=0;e<t*this.simulation_params.sim_time_per_day;e++){this.event_queue.run_events_fired(this.cur_sim_time,500);E.Common.choose(this.agents);G.update(this.matter_engine,1e3/60),this.cur_sim_time=this.matter_engine.timing.timestamp}},Z.prototype.setup_matter_env=function(){var t=this;x.clear(),this.locations=[],this.migration_graph.clear(),this.location_uuid_hash={},this.agents=[],this.cohorts=[],this.cur_sim_time=0,this.state_counts=[],this.matter_engine.timing.timestamp=0;for(var e=0;e<F.size;e++)this.state_counts.push(0);this.headless||(K.on(this.matter_render,"beforeRender",(function(e){t.cur_sim_time=e.timestamp,t.event_queue.run_events_fired(t.cur_sim_time,500)})),K.on(this.matter_render,"afterRender",(function(e){var n=t.matter_render.context;if(n){for(var o=0;o<t.locations.length;o++)t.locations[o].draw_borders(n);t.agents.forEach((function(e){e.masked&&e.draw_mask(n,t.simulation_params.agent_size)}))}}))),this.add_event({time:100,callback:this.pulse_orgs_event(),recurring:!0})},Z.prototype.update_org_state=function(t,e){var n=t.agent_object.state;t.agent_object.state=e,"undefined"!==typeof n&&(this.state_counts[n]-=1),this.state_counts[e]+=1,t.render.lineWidth=10;t.render.strokeStyle;switch(e){case F.EXPOSED:"orange","e",t.render.sprite.texture=k;break;case F.S_INFECTED:case F.A_INFECTED:"red",4278190335,"i",t.render.sprite.texture=k;break;case F.RECOVERED:"blue",4294967295,"r",t.render.sprite.texture="data:image/png;base64,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";break;case F.SENSITIVE:t.render.lineWidth=0,"",t.render.sprite.texture=v}return t},Z.prototype.add_location=function(t,e){var n=new I(t);return n.border_color=e.border_color,n.set_bounds(e.bounds),n.friction=e.friction,n.type=e.type||"none",n.home_color=this.simulation_colors.matter_colors[this.locations.length],n.viva_node_color=this.simulation_colors.viva_colors[this.locations.length],this.locations.push(n),this.location_uuid_hash[n.uuid]=n,n},Z.prototype.add_cohort=function(){var t=new w;return this.cohorts.push(t),t},Z.prototype.assign_cohort=function(t,e){e.add_agent(t.agent_object)},Z.prototype.expose_org=function(t,e,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;n&&n.pathogen?t.agent_object.pathogen=n.pathogen.get_offspring(this.simulation_params.pathogen_mut_prob):t.agent_object.pathogen=new f(.5,"root",i),this.update_org_state(t,F.S_INFECTED),this.post_infection_callback&&this.post_infection_callback(t.agent_object,n),this.add_event({time:Math.max(_.jStat.normal.sample(this.infection_params.incubation_period_mu,this.infection_params.incubation_period_sigma),1)*this.simulation_params.sim_time_per_day,callback:function(){o.update_org_state(t,e);var n=0;n=e==F.A_INFECTED?Math.max(_.jStat.normal.sample(o.infection_params.asymptomatic_infectious_period_mu,o.infection_params.asymptomatic_infectious_period_sigma),.5):Math.max(_.jStat.normal.sample(o.infection_params.infectious_period_mu,o.infection_params.infectious_period_sigma),4),o.add_event({time:n*o.simulation_params.sim_time_per_day,callback:function(){o.update_org_state(t,F.RECOVERED)}})}})},Z.prototype.register_infection_callback=function(t){this.post_infection_callback=t},Z.prototype._check_edge_for_removal=function(t){var e=this;return function(){t.data.timestamp<e.cur_sim_time-e.simulation_params.link_lifetime?x.removeLink(t):e.add_event({time:e.cur_sim_time+e.simulation_params.link_lifetime-t.data.timestamp,callback:e._check_edge_for_removal(t)})}},Z.prototype.calc_prob_infection=function(t,e){return this.infection_params.per_contact_infection},Z.prototype._default_interaction_callback=function(t){var e=this;return function(n){var o;n.state!=F.S_INFECTED&&n.state!=F.A_INFECTED||t.agent_object.state!=F.SUSCEPTIBLE||E.Common.random(0,1)<e.calc_prob_infection(t,n.body)&&(o=E.Common.random(0,1)<e.infection_params.fraction_asymptomatic?F.A_INFECTED:F.S_INFECTED,e.expose_org(t,o,n));C(n.uuid&&t.agent_object.uuid);var i=x.hasLink(t.agent_object.uuid,n.uuid)||x.hasLink(n.uuid,t.agent_object.uuid);i?i.data.timestamp=e.cur_sim_time:(C(x.hasNode(t.agent_object.uuid)&&x.hasNode(t.agent_object.uuid)),i=x.addLink(t.agent_object.uuid,n.uuid,{origin:t.agent_object.uuid,timestamp:e.cur_sim_time}),e.add_event({time:e.simulation_params.link_lifetime+1,callback:e._check_edge_for_removal(i)}))}},Z.prototype.add_agent=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.SUSCEPTIBLE;C(t&&t.get_random_position);var n=t.get_random_position(),o=v,i=W.circle(n.x,n.y,this.simulation_params.agent_size,{render:{sprite:{texture:o,xScale:.15,yScale:.15}},plugin:{wrap:t.bounds}});return E.Body.setInertia(i,1/0),i.agent_object=new Q(i),i.frictionAir=t.friction,i.friction=0,i.restitution=1.1,i.node=x.addNode(i.agent_object.uuid,{something:!0}),i.agent_object.home=t,i.agent_object.viva_color=t.viva_node_color,t.add_agent(i.agent_object),i.agent_object.register_interaction_callback(this._default_interaction_callback(i,this.get_prob_of_infection)),i.onCollide((function(t){t.bodyA===i&&t.bodyB.agent_object?t.bodyA.agent_object.handle_agent_contact(t.bodyB.agent_object):t.bodyB===i&&t.bodyA.agent_object&&t.bodyB.agent_object.handle_agent_contact(t.bodyA.agent_object)})),S.add(this.matter_engine.world,i),this.agents.push(i.agent_object),this.update_org_state(i,e),i},Z.prototype.add_event=function(t){C(t.time&&t.callback),this.event_queue.add_event(this.cur_sim_time,t)},Z.prototype.set_agent_contact_callback=function(t){this.agent_contact_callback=t},Z.prototype.clear_simulator=function(){S.clear(this.matter_engine.world),G.clear(this.matter_engine),this.event_queue.clear_events()},Z.prototype.remove_simulator=function(){this.clear_simulator(),R.stop(),this.matter_engine.events={},this.matter_render.canvas.remove(),this.matter_render.canvas=null,this.matter_render.context=null,this.matter_render.textures={},this.matter_world=null,this.matter_engine=null,this.event_queue=null,this.matter_render=null,this.mouseConstraint=null},Z.prototype.pulse_orgs_event=function(){var t=this;return function(){if(t.agents.length>0)for(var e=0;e<100;e++){var n=E.Common.choose(t.agents);E.Body.applyForce(n.body,n.body.position,{x:E.Common.random(-2e-5*t.infection_params.movement_scale,2e-5*t.infection_params.movement_scale),y:E.Common.random(-2e-5*t.infection_params.movement_scale,2e-5*t.infection_params.movement_scale)})}}},Z.prototype.get_migration_links=function(){var t=[];return this.migration_graph.forEachLink((function(e){t.push({from_uuid:e.fromId,to_uuid:e.toId,num_agents:e.data.num_agents})})),t},Z.prototype.add_migration_link=function(t,e,n){var o=this.migration_graph.hasLink(t,e);o?o.data.num_agents=n:this.migration_graph.addLink(t,e,{num_agents:n})},Z.prototype.remove_migration_link=function(t,e){var n=this.migration_graph.hasLink(t,e);n&&this.migration_graph.removeLink(n)},Z.prototype.new_migration_event=function(){var t=this;return function(){t.migration_graph.forEachLink((function(e){var n=t.location_uuid_hash[e.fromId],o=t.location_uuid_hash[e.toId];n.try_getting_random_residents(e.data.num_agents).forEach((function(e){e.home_state={location:n,position:Object(d.a)({},e.body.position),velocity:Object(d.a)({},e.body.velocity)},n.migrate_to(o,e,(function(t){t.body.plugin.wrap=o.bounds,E.Body.setPosition(t.body,o.get_random_position()),t.body.frictionAir=o.friction,t.migrating=!0})),t.add_event({time:t.simulation_params.sim_time_per_day,callback:function(){o.migrate_to(n,e,(function(t){E.Body.setPosition(t.body,e.home_state.position),t.body.plugin.wrap=n.bounds,E.Body.setVelocity(t.body,e.home_state.velocity),t.body.frictionAir=n.friction,t.migrating=!1}))}})}))}))}};n(331);var U=n(111),T=n.n(U);T.a.Graph.Layout.forceDirected(x,{springLength:15,springCoeff:5e-5,dragCoeff:.01,gravity:-1.5}),T.a.Graph.View.webglGraphics(),n(149),n(184);n(372);var H=n(108),J=n.n(H),X=n(543),P=n(517),z=n(511),$=n(355),tt=n(541),et=Object(u.a)((function(t){return{root:{flexGrow:0,minWidth:1200},controlls:{width:600},paper:{minHeight:400,minWidth:400,textAlign:"center"},paperControlls:{minHeight:400,minWidth:400,textAlign:"center",padding:t.spacing(2)}}}));Z.prototype.mask_transmission_props={self_protection:.05,others_protection:.5},Z.prototype.calc_prob_infection=function(t,e){return this.infection_params.use_pathogen_contagiousness?e.agent_object.pathogen.contagiousness:this.infection_params.per_contact_infection};var nt=function(t,e){if("setup_environment"==e.type&&(t.current.setup_renderer(e.payload.sim_div.current),t.current.setup_matter_env()),"update_mask_transmission_params"==e.type&&(e.payload.self_protection&&(t.current.mask_transmission_props.self_protection=e.payload.self_protection),e.payload.others_protection&&(t.current.mask_transmission_props.others_protection=e.payload.others_protection)),"update_movement_scale"==e.type&&e.payload.movement_scale&&(t.current.infection_params.movement_scale=e.payload.movement_scale),"reset_simulator"==e.type&&(t.current.clear_simulator(),t.current.setup_matter_env()),"add_location"==e.type)return t.current.add_location("residence",e.payload.residence_props);if("add_agents"==e.type){var n=null;if(e.payload.residence&&e.payload.num_agents)for(var o=0;o<e.payload.num_agents;o++)n=t.current.add_agent(e.payload.residence);e.payload.callback&&n&&e.payload.callback(n.agent_object)}if("map_agents"==e.type)return t.current.agents.map((function(t,n){return e.payload.callback(t,n)}));if("forEach_agents"==e.type&&t.current.agents.forEach((function(t){return e.payload.callback(t)})),"map_locations"==e.type)return t.current.locations.map((function(t,n){return e.payload.callback(t,n)}));if("forEach_location"==e.type&&t.current.locations.forEach((function(t){return e.payload.callback(t)})),"infect_random_agents"==e.type&&e.payload.num_agents)for(var i=0;i<e.payload.num_agents;i++){var a=J.a.Common.choose(t.current.agents);t.current.expose_org(a.body,F.S_INFECTED)}if("infect_each_location"==e.type&&e.payload.num_agents&&e.payload.infection_probs&&t.current.locations.forEach((function(n,o){n.try_getting_random_residents(e.payload.num_agents).forEach((function(n){console.log(e.payload.infection_probs[o]),t.current.expose_org(n.body,F.S_INFECTED,null,e.payload.infection_probs[o])}))})),"get_migration_links"==e.type)return t.current.get_migration_links();if("add_migration_link"==e.type&&t.current.add_migration_link(e.payload.from_location,e.payload.to_location,e.payload.num_agents),"clear_migration_links"==e.type&&t.current.migration_graph.clear(),"remove_migration_link"==e.type&&t.current.remove_migration_link(e.payload.from_location,e.payload.to_location),"get_state_counts"==e.type)return{state_counts:t.current.state_counts,cur_time:t.current.cur_sim_time/t.current.simulation_params.sim_time_per_day};if("set_num_mask"==e.type){var r=[],s=[];t.current.agents.forEach((function(t){t.masked?r.push(t):s.push(t)}));var c=r.length,m=e.payload.num_masked-c;if(m>0)for(var u=0;u<m;u++)s[u].masked=!0;else if(m<0)for(var l=0;l<-m;l++)r[l].masked=!1}},ot=function(t){var e=et(),n=Object(o.useRef)(null),i=Object(o.useState)(0),a=Object(s.a)(i,2),r=a[0],u=(a[1],Object(o.useState)(.05)),d=Object(s.a)(u,2),_=d[0],p=(d[1],Object(o.useState)(.5)),h=Object(s.a)(p,2),g=h[0],f=(h[1],Object(o.useState)(3)),b=Object(s.a)(f,2),v=b[0],k=b[1],E=Object(o.useState)(0),j=Object(s.a)(E,2),C=j[0],O=j[1],x=Object(o.useState)(0),I=Object(s.a)(x,2),w=(I[0],I[1]);return Object(o.useEffect)((function(){nt(n,{type:"update_mask_transmission_params",payload:{self_protection:_}})}),[_]),Object(o.useEffect)((function(){nt(n,{type:"update_mask_transmission_params",payload:{others_protection:g}})}),[g]),Object(o.useEffect)((function(){nt(n,{type:"update_movement_scale",payload:{movement_scale:v}})}),[v]),Object(o.useEffect)((function(){nt(n,{type:"set_num_mask",payload:{num_masked:r}})}),[r]),Object(y.jsxs)("div",{className:"App",children:[Object(y.jsx)(m.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:e.root,spacing:3,children:Object(y.jsx)(m.a,{item:!0,children:Object(y.jsx)(l.a,{className:e.paper,children:Object(y.jsx)(A,{InfectiousMatterRef:n,InfectiousMatterAPI:nt,redraw_trigger:C,setWorldReadyTrigger:w,numMasked:r})})})}),Object(y.jsx)(m.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:e.root,spacing:10,children:Object(y.jsx)(m.a,{item:!0,alignItems:"flex-start",children:Object(y.jsx)(l.a,{className:e.paper,children:Object(y.jsxs)(P.a,{children:[Object(y.jsx)(tt.a,{disableSticky:!0,children:"World Settings"}),Object(y.jsxs)(z.a,{children:[Object(y.jsx)($.a,{id:"Movement",primary:"Movement Scale"}),Object(y.jsx)(X.a,{value:v,"aria-labelledby":"discrete-slider",valueLabelDisplay:"on",onChange:function(t,e){k(e)},step:.25,min:0,max:10})]}),Object(y.jsx)(z.a,{children:Object(y.jsxs)(m.a,{container:!0,direction:"row",spacing:3,children:[Object(y.jsx)(m.a,{item:!0,children:Object(y.jsx)(c.a,{variant:"contained",onClick:function(t){nt(n,{type:"reset_simulator"}),O((function(t){return t+1}))},children:"Reset"})}),Object(y.jsx)(m.a,{item:!0,children:Object(y.jsx)(c.a,{variant:"contained",onClick:function(t){nt(n,{type:"infect_each_location",payload:{num_agents:2,infection_probs:[.9,.3]}})},children:"Infect Random Agent"})})]})})]})})})})]})};r.a.render(Object(y.jsx)(i.a.StrictMode,{children:Object(y.jsx)(ot,{})}),document.getElementById("root"))}},[[509,1,2]]]);
//# sourceMappingURL=main.7c2b7d35.chunk.js.map