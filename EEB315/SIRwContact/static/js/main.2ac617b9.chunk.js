(this.webpackJsonpinfectious_matter_component=this.webpackJsonpinfectious_matter_component||[]).push([[0],{326:function(e,t,n){var a=n(231);function o(e){this.track_all_contacts=!0,this.state=void 0,this.body=e,this.interaction_callback=void 0,this.uuid=a(),this.viva_color=void 0,this.events=[],this.location=void 0,this.home=void 0,this.cohorts=[],this.color=void 0,this.home_state={},this.migrating=!1,this.masked=!1}o.prototype.add_body=function(e){this.body=e},o.prototype.register_interaction_callback=function(e){this.interaction_callback=e},o.prototype.handle_agent_contact=function(e){this.interaction_callback(e)},o.prototype.draw_mask=function(e,t){e.fillStyle="#FFFFFF",e.strokeStyle="#000000",e.lineWidth=1,e.fillRect(this.body.position.x-t,this.body.position.y,2*t,t-1),e.strokeRect(this.body.position.x-t,this.body.position.y,2*t,t-1),e.stroke()},e.exports=o},358:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=358},419:function(e,t,n){var a={name:"matter-collision-events",version:"0.1.5",for:"matter-js@^0.12.0",install:function(e){var t=e.Body.create;e.Body.create=function(){var e=t.apply(null,arguments);return e.onCollide=function(t){e._mceOC=t},e.onCollideEnd=function(t){e._mceOCE=t},e.onCollideActive=function(t){e._mceOCA=t},e},e.after("Engine.create",(function(){e.Events.on(this,"collisionStart",(function(t){t.pairs.map((function(t){e.Events.trigger(t.bodyA,"onCollide",{pair:t}),e.Events.trigger(t.bodyB,"onCollide",{pair:t}),t.bodyA._mceOC&&t.bodyA._mceOC(t),t.bodyB._mceOC&&t.bodyB._mceOC(t)}))})),e.Events.on(this,"collisionActive",(function(t){t.pairs.map((function(t){e.Events.trigger(t.bodyA,"onCollideActive",{pair:t}),e.Events.trigger(t.bodyB,"onCollideActive",{pair:t}),t.bodyA._mceOCA&&t.bodyA._mceOCA(t),t.bodyB._mceOCA&&t.bodyB._mceOCA(t)}))})),e.Events.on(this,"collisionEnd",(function(t){t.pairs.map((function(t){e.Events.trigger(t.bodyA,"onCollideEnd",{pair:t}),e.Events.trigger(t.bodyB,"onCollideEnd",{pair:t}),t.bodyA._mceOCE&&t.bodyA._mceOCE(t),t.bodyB._mceOCE&&t.bodyB._mceOCE(t)}))}))}))}};n(85).Plugin.register(a),e.exports.MatterCollisionEvents=a},423:function(e,t,n){var a=n(231);function o(e,t){return Math.random()*(t-e)+e}function i(e){this.name=e,this.uuid=a(),this.bounds=void 0,this.friction=.2,this.occupants=[],this.border_color=void 0}i.prototype.draw_borders=function(e,t){t=t&&this.border_color?t||this.border_color:"black";var n=this.bounds.max.x-this.bounds.min.x,a=this.bounds.max.y-this.bounds.min.y;e.beginPath(),e.rect(this.bounds.min.x-2,this.bounds.min.y-2,n+4,a+4),e.strokeStyle=t,e.lineWidth=2,e.stroke()},i.prototype.get_random_position=function(){return this.bounds?{x:o(this.bounds.min.x,this.bounds.max.x),y:o(this.bounds.min.y,this.bounds.max.y)}:{x:0,y:0}},i.prototype.remove_agent=function(e){this.occupants=this.occupants.filter((function(t){return t!==e})),e.location=void 0},i.prototype.set_bounds=function(e){this.bounds=e},i.prototype.migrate_to=function(e,t,n){this.remove_agent(t),e.add_agent(t),n&&n(t)},i.prototype.try_getting_random_residents=function(e){for(var t,n=[],a=0;a<e;a++){var o=(t=this.occupants)[Math.floor(t.length*Math.random())];o&&0==o.migrating&&n.push(o)}return n},i.prototype.add_agent=function(e){this.occupants.push(e),e.location=this},e.exports=i},424:function(e,t){function n(){this.members=[]}n.prototype.move_cohort=function(e,t){for(var n=0;n<this.members.length;n++){var a=this.members[n];a.location.migrate_to(e,a,t)}},n.prototype.send_cohort_home=function(e){for(var t=0;t<this.members.length;t++){var n=this.members[t];n.location.migrate_to(n.home,n,e)}},n.prototype.add_agent=function(e,t){this.members.push(e),e.cohorts.push(this),t&&t(e)},e.exports=n},425:function(e,t,n){var a=n(426),o=n(325);function i(){this.fast_queue=new a((function(e,t){return e.time<t.time}))}i.prototype.add_event=function(e,t){o(t.time&&t.callback),t.original_time=t.time,t.time+=e,this.fast_queue.add(t)},i.prototype.run_events_fired=function(e,t){for(var n=0;this.fast_queue.peek()&&this.fast_queue.peek().time<e&&n<t;){var a=this.fast_queue.poll();0==a.stale&&(a.recurring&&this.add_event(e,{time:a.original_time,callback:a.callback,recurring:!0,stale:!1}),a.callback(),n+=1)}},i.prototype.clear_events=function(){this.fast_queue=null,this.fast_queue=new a((function(e,t){return e.time<t.time}))},e.exports=i},501:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(15),r=n.n(i),s=n(28),c=n(348),_=n(527),u=n(347),l=n(528),m=n(88),d=n(121),p=n(231),f=function(e){var t=e.color_float+d.jStat.exponential.sample(8),n=Math.min(e.contagiousness+d.jStat.normal.sample(0,.1),1);t%=1,this.color_float=t,this.contagiousness=n};function h(e,t){this.parent=void 0,this.interaction_callback=void 0,this.uuid=p(),this.color_float=e||Math.random(),this.mutation_function=f,this.contagiousness=.5}h.prototype.get_offspring=function(e){var t=new h(this.color_float);return Math.random()<e&&this.mutation_function&&t.mutation_function(this),t};var g=h,y=n(85),b=(n(110),function(e){var t=e.InfectiousMatterRef,n=e.InfectiousMatterAPI,i=e.redraw_trigger,r=e.setWorldReadyTrigger,s=e.numMasked,c=e.popSize,_=Object(a.useRef)(null),u=function(e){var a=n(t,{type:"add_location",payload:{residence_props:{type:"residence",friction:.01,bounds:{min:{x:10,y:10},max:{x:390,y:390}}}}});n(t,{type:"add_agents",payload:{residence:a,num_agents:c}}),y.Common.shuffle(t.current.agents),n(t,{type:"set_num_mask",payload:{num_masked:e}})};return Object(a.useEffect)((function(){var e={sim_time_per_day:1e3,agent_size:4,link_lifetime:200};e.link_lifetime=7*e.sim_time_per_day;console.log("initalizing matter"),t.current=new W(!1,e,{per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:2},{viva_colors:[2846468607,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["darkgrey","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]}),n(t,{type:"setup_environment",payload:{sim_div:_}}),u(s)}),[]),Object(a.useLayoutEffect)((function(){t.current&&(u(s),r((function(e){return e+1})))}),[i]),o.a.createElement("div",null,o.a.createElement("div",{ref:_,style:{height:400,width:400}}))}),v=n(85);n(418);var k=n(419).MatterCollisionEvents;v.use("matter-wrap",k),v._seed=2,Math.random=v.Common.random,d.jStat._random_fn=v.Common.random;var E=n(325),j=n(110),C=new j.Graph.graph,O=n(423),x=n(424),w=n(425),I=n(326),S=n(428),A=(S({colormap:"chlorophyll",nshades:9,format:"hex",alpha:1}),S({colormap:"portland",nshades:15,format:"hex",alpha:1}),n(430)(["white"])),M={SUSCEPTIBLE:0,INFECTED:1,RECOVERED:2,size:3},R=v.Engine,B=v.Render,L=v.World,N=(v.Body,v.Bodies),D=(v.Bounds,v.Mouse),z=v.MouseConstraint,P=v.Events,T={sim_time_per_day:2e3,agent_size:3,link_lifetime:4e3,pathogen_mut_prob:.1},q={per_contact_infection:.5,incubation_period_mu:5,incubation_period_sigma:3,infectious_period_mu:7,infectious_period_sigma:4,fraction_asymptomatic:.2,asymptomatic_infectious_period_mu:1.5,asymptomatic_infectious_period_sigma:1.5,fraction_seek_care:.5,fraction_isolate:.2,time_to_seek_care:2.5,movement_scale:.2,use_pathogen_contagiousness:!1},F={viva_colors:[2332068863,16711935,4294902015,4289003775,65535,2846468607,4278255615,13554175,2566625535,3448061951],matter_colors:["darkmagenta","lime","yellow","orange","blue","darkgrey","fuchsia","darkturquoise","palegreen","peru"]};function W(e,t,n,a){this.simulation_params=v.Common.extend(T,t),this.infection_params=v.Common.extend(q,n),this.simulation_colors=v.Common.extend(F,a),this.matter_world=L.create(),this.headless=e||!1,this.pathogen_color_range=A,console.log("creating infectious matter environment!"),this.matter_engine=R.create({positionIterations:15,velocityIterations:15,constraintIterations:10}),this.matter_engine.world.gravity.y=0,this.event_queue=new w,this.migration_graph=new j.Graph.graph}W.prototype.setup_renderer=function(e){var t=e;this.matter_render=B.create({element:t,engine:this.matter_engine,options:{height:t.offsetHeight,width:t.offsetWidth,background:"rgba(229,229,229)",wireframes:!1}});var n=D.create(this.matter_render.canvas);this.mouseConstraint=z.create(this.matter_engine,{mouse:n,constraint:{stiffness:.1,render:{visible:!0}}}),n.element.removeEventListener("mousewheel",n.mousewheel),n.element.removeEventListener("DOMMouseScroll",n.mousewheel),this.matter_render.mouse=n,L.add(this.matter_engine.world,this.mouseConstraint),B.run(this.matter_render),R.run(this.matter_engine)},W.prototype.run_headless=function(e){if(e=e||30,this.run_headless)for(var t=0;t<e*this.simulation_params.sim_time_per_day;t++){this.event_queue.run_events_fired(this.cur_sim_time,500);v.Common.choose(this.agents);R.update(this.matter_engine,1e3/60),this.cur_sim_time=this.matter_engine.timing.timestamp}},W.prototype.setup_matter_env=function(){var e=this;C.clear(),this.locations=[],this.migration_graph.clear(),this.location_uuid_hash={},this.agents=[],this.cohorts=[],this.cur_sim_time=0,this.state_counts=[],this.matter_engine.timing.timestamp=0;for(var t=0;t<M.size;t++)this.state_counts.push(0);this.headless||(P.on(this.matter_render,"beforeRender",(function(t){e.cur_sim_time=t.timestamp,e.event_queue.run_events_fired(e.cur_sim_time,500)})),P.on(this.matter_render,"afterRender",(function(t){var n=e.matter_render.context;if(n){for(var a=0;a<e.locations.length;a++)e.locations[a].draw_borders(n);e.agents.forEach((function(t){t.masked&&t.draw_mask(n,e.simulation_params.agent_size)}))}}))),this.add_event({time:100,callback:this.pulse_orgs_event(),recurring:!0,stale:!1})},W.prototype.update_org_state=function(e,t){var n=e.agent_object.state;e.agent_object.state=t,"undefined"!==typeof n&&(this.state_counts[n]-=1),this.state_counts[t]+=1,e.render.lineWidth=3;var a=e.render.strokeStyle;switch(t){case M.INFECTED:a="red",4278190335;break;case M.RECOVERED:a="blue",4294967295;break;case M.SENSITIVE:a="black",e.render.lineWidth=0}return e.render.strokeStyle=a,e},W.prototype.add_location=function(e,t){var n=new O(e);return n.border_color=t.border_color,n.set_bounds(t.bounds),n.friction=t.friction,n.type=t.type||"none",n.home_color=this.simulation_colors.matter_colors[this.locations.length],n.viva_node_color=this.simulation_colors.viva_colors[this.locations.length],this.locations.push(n),this.location_uuid_hash[n.uuid]=n,n},W.prototype.add_cohort=function(){var e=new x;return this.cohorts.push(e),e},W.prototype.assign_cohort=function(e,t){t.add_agent(e.agent_object)},W.prototype.expose_org=function(e,t,n){var a=this;n&&n.pathogen?e.agent_object.pathogen=n.pathogen.get_offspring(this.simulation_params.pathogen_mut_prob):e.agent_object.pathogen=new g(.5,"root"),this.update_org_state(e,M.INFECTED),this.post_infection_callback&&this.post_infection_callback(e.agent_object,n);var o={time:Math.max(d.jStat.exponential.sample(1/this.infection_params.infectious_period_mu),3)*this.simulation_params.sim_time_per_day,callback:function(){a.update_org_state(e,M.RECOVERED)},stale:!1};this.add_event(o),e.agent_object.events.push(o)},W.prototype.register_infection_callback=function(e){this.post_infection_callback=e},W.prototype._check_edge_for_removal=function(e){var t=this;return function(){e.data.timestamp<t.cur_sim_time-t.simulation_params.link_lifetime?C.removeLink(e):t.add_event({time:t.cur_sim_time+t.simulation_params.link_lifetime-e.data.timestamp,callback:t._check_edge_for_removal(e)})}},W.prototype.calc_prob_infection=function(e,t){return this.infection_params.per_contact_infection},W.prototype._default_interaction_callback=function(e){var t=this;return function(n){n.state==M.INFECTED&&e.agent_object.state==M.SUSCEPTIBLE&&v.Common.random(0,1)<t.calc_prob_infection(e,n.body)&&t.expose_org(e,M.INFECTED,n),E(n.uuid&&e.agent_object.uuid);var a=C.hasLink(e.agent_object.uuid,n.uuid)||C.hasLink(n.uuid,e.agent_object.uuid);a?a.data.timestamp=t.cur_sim_time:(E(C.hasNode(e.agent_object.uuid)&&C.hasNode(e.agent_object.uuid)),a=C.addLink(e.agent_object.uuid,n.uuid,{origin:e.agent_object.uuid,timestamp:t.cur_sim_time}),t.add_event({time:t.simulation_params.link_lifetime+1,callback:t._check_edge_for_removal(a),stale:!1}))}},W.prototype.add_agent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M.SUSCEPTIBLE;E(e&&e.get_random_position);var n=e.get_random_position(),a=N.circle(n.x,n.y,this.simulation_params.agent_size,{plugin:{wrap:e.bounds}});return a.render.fillStyle=e.home_color||"black",a.strokeStyle="black",a.lineWidth=2,a.agent_object=new I(a),a.frictionAir=e.friction,a.friction=0,a.restitution=1.1,a.node=C.addNode(a.agent_object.uuid,{something:!0}),a.agent_object.home=e,a.agent_object.viva_color=e.viva_node_color,e.add_agent(a.agent_object),a.agent_object.register_interaction_callback(this._default_interaction_callback(a,this.get_prob_of_infection)),a.onCollide((function(e){e.bodyA===a&&e.bodyB.agent_object?e.bodyA.agent_object.handle_agent_contact(e.bodyB.agent_object):e.bodyB===a&&e.bodyA.agent_object&&e.bodyB.agent_object.handle_agent_contact(e.bodyA.agent_object)})),L.add(this.matter_engine.world,a),this.agents.push(a.agent_object),this.update_org_state(a,t),a},W.prototype.delete_agent=function(e){this.agents=this.agents.filter((function(t){return t!==e})),v.Composite.remove(this.matter_engine.world,e.body),C.removeNode(e.uuid),this.state_counts[e.state]-=1,e.events.forEach((function(e){e.stale=!0}))},W.prototype.add_event=function(e){E(e.time&&e.callback),this.event_queue.add_event(this.cur_sim_time,e)},W.prototype.set_agent_contact_callback=function(e){this.agent_contact_callback=e},W.prototype.clear_simulator=function(){L.clear(this.matter_engine.world),R.clear(this.matter_engine),this.event_queue.clear_events()},W.prototype.remove_simulator=function(){this.clear_simulator(),B.stop(),this.matter_engine.events={},this.matter_render.canvas.remove(),this.matter_render.canvas=null,this.matter_render.context=null,this.matter_render.textures={},this.matter_world=null,this.matter_engine=null,this.event_queue=null,this.matter_render=null,this.mouseConstraint=null},W.prototype.pulse_orgs_event=function(){var e=this;return function(){if(e.agents.length>0)for(var t=0;t<100;t++){var n=v.Common.choose(e.agents);v.Body.applyForce(n.body,n.body.position,{x:v.Common.random(-2e-5*e.infection_params.movement_scale,2e-5*e.infection_params.movement_scale),y:v.Common.random(-2e-5*e.infection_params.movement_scale,2e-5*e.infection_params.movement_scale)})}}},W.prototype.get_migration_links=function(){var e=[];return this.migration_graph.forEachLink((function(t){e.push({from_uuid:t.fromId,to_uuid:t.toId,num_agents:t.data.num_agents})})),e},W.prototype.add_migration_link=function(e,t,n){var a=this.migration_graph.hasLink(e,t);a?a.data.num_agents=n:this.migration_graph.addLink(e,t,{num_agents:n})},W.prototype.remove_migration_link=function(e,t){var n=this.migration_graph.hasLink(e,t);n&&this.migration_graph.removeLink(n)},W.prototype.new_migration_event=function(){var e=this;return function(){e.migration_graph.forEachLink((function(t){var n=e.location_uuid_hash[t.fromId],a=e.location_uuid_hash[t.toId];n.try_getting_random_residents(t.data.num_agents).forEach((function(t){t.home_state={location:n,position:Object(m.a)({},t.body.position),velocity:Object(m.a)({},t.body.velocity)},n.migrate_to(a,t,(function(e){e.body.plugin.wrap=a.bounds,v.Body.setPosition(e.body,a.get_random_position()),e.body.frictionAir=a.friction,e.migrating=!0})),e.add_event({time:e.simulation_params.sim_time_per_day,callback:function(){a.migrate_to(n,t,(function(e){v.Body.setPosition(e.body,t.home_state.position),e.body.plugin.wrap=n.bounds,v.Body.setVelocity(e.body,t.home_state.velocity),e.body.frictionAir=n.friction,e.migrating=!1}))}})}))}))}};n(326);var U=n(110),V=n.n(U),G=V.a.Graph.Layout.forceDirected(C,{springLength:15,springCoeff:5e-5,dragCoeff:.01,gravity:-1.5}),H=V.a.Graph.View.webglGraphics(),J=function(e){var t=e.InfectiousMatterRef,n=e.InfectiousMatterAPI,i=e.worldReadyTrigger,r=Object(a.useRef)(null);return Object(a.useEffect)((function(){console.log("initalizing viva graph");var e=V.a.Graph.View.renderer(C,{container:r.current,graphics:H,renderLinks:!0,layout:G,interactive:"node drag"});e.run();for(var t=0;t<30;t++)e.zoomOut()}),[]),Object(a.useEffect)((function(){n(t,{type:"forEach_agents",payload:{callback:function(e){H.getNodeUI(e.uuid).color=e.viva_color,H.getNodeUI(e.uuid).size=40}}})}),[i]),o.a.createElement("div",{ref:r,style:{width:400,height:400}})},K=n(148);n(183);var Q=n(369),X=n.n(Q),Y={margin:{l:50,r:10,b:50,t:10,pad:10},showlegend:!0,legend:{x:1,xanchor:"right",y:1},xaxis:{title:"Days",rangemode:"nonnegative"},yaxis:{title:"Count",rangemode:"nonnegative"},width:390,height:390},Z=[{x:[0],y:[0],stackgroup:"one",type:"scattergl",name:"Infected",marker:{color:"red"}},{x:[0],y:[0],stackgroup:"one",name:"Recovered",type:"scattergl",marker:{color:"blue"}},{x:[0],y:[0],stackgroup:"one",name:"Susceptible",type:"scattergl",marker:{color:"grey"}}];function $(e,t){e||console.log("didnt get state");var n=Object(K.a)(e);switch(t.type){case"extend":return n[0].x.push(t.payload.cur_time),n[0].y.push(t.payload.cur_state_counts[M.INFECTED]),n[1].x.push(t.payload.cur_time),n[1].y.push(t.payload.cur_state_counts[M.RECOVERED]),n[2].x.push(t.payload.cur_time),n[2].y.push(t.payload.cur_state_counts[M.SUSCEPTIBLE]),n;case"reset":return n=[{x:[0],y:[0],stackgroup:"one",type:"scattergl",name:"Infected",marker:{color:"red"}},{x:[0],y:[0],stackgroup:"one",name:"Recovered",type:"scattergl",marker:{color:"blue"}},{x:[0],y:[0],stackgroup:"one",name:"Susceptible",type:"scattergl",marker:{color:"grey"}}]}}var ee=function(e){var t=e.InfectiousMatterRef,n=e.InfectiousMatterAPI,i=e.redraw_trigger,r=Object(a.useReducer)($,Z),c=Object(s.a)(r,2),_=c[0],u=c[1],l=Object(a.useState)(0),d=Object(s.a)(l,2),p=d[0],f=d[1],h=Y;return Object(a.useEffect)((function(){var e=setInterval((function(){!function(){var e=n(t,{type:"get_state_counts"});u({type:"extend",payload:{cur_time:e.cur_time,cur_state_counts:e.state_counts}}),f((function(e){return e+1}))}()}),600);return function(){clearInterval(e)}}),[i]),Object(a.useLayoutEffect)((function(){t.current&&(u({type:"reset"}),f((function(e){return e+1})))}),[i]),o.a.createElement(X.a,{data:_,layout:Object(m.a)(Object(m.a)({},h),{},{datarevision:p})})},te=n(85),ne=n.n(te),ae=n(531),oe=n(509),ie=n(503),re=n(352),se=n(529),ce=Object(u.a)((function(e){return{root:{flexGrow:0,minWidth:1200},controlls:{width:600},paper:{minHeight:400,minWidth:400,textAlign:"center"},paperControlls:{minHeight:400,minWidth:800,textAlign:"center",padding:e.spacing(2)}}}));W.prototype.mask_transmission_props={self_protection:.05,others_protection:.5},W.prototype.calc_prob_infection=function(e,t){var n=this.infection_params.per_contact_infection;return e.agent_object.masked&&t.agent_object.masked?n*(1-this.mask_transmission_props.self_protection)*(1-this.mask_transmission_props.others_protection):e.agent_object.masked&&!t.agent_object.masked?n*(1-this.mask_transmission_props.self_protection):!e.agent_object.masked&&t.agent_object.masked?n*(1-this.mask_transmission_props.others_protection):e.agent_object.masked||t.agent_object.masked?void 0:n};var _e=function e(t,n){if("setup_environment"==n.type&&(t.current.setup_renderer(n.payload.sim_div.current),t.current.setup_matter_env()),"update_infection_params"==n.type&&(n.payload.per_contact_infection&&(t.current.infection_params.per_contact_infection=n.payload.per_contact_infection),n.payload.infectious_period_mu&&(t.current.infection_params.infectious_period_mu=n.payload.infectious_period_mu)),"update_mask_transmission_params"==n.type&&(n.payload.self_protection&&(t.current.mask_transmission_props.self_protection=n.payload.self_protection),n.payload.others_protection&&(t.current.mask_transmission_props.others_protection=n.payload.others_protection)),"update_movement_scale"==n.type&&n.payload.movement_scale&&(t.current.infection_params.movement_scale=n.payload.movement_scale),"reset_simulator"==n.type&&(t.current.clear_simulator(),t.current.setup_matter_env()),"add_location"==n.type)return t.current.add_location("residence",n.payload.residence_props);if("add_random_agent"==n.type){var a=ne.a.Common.choose(t.current.locations),o=t.current.add_agent(a);n.payload&&n.payload.callback&&o&&n.payload.callback(o.agent_object)}if("remove_random_agent"==n.type){var i=ne.a.Common.choose(t.current.agents);t.current.delete_agent(i)}if("add_agents"==n.type){var r=null;if(n.payload.residence&&n.payload.num_agents)for(var s=0;s<n.payload.num_agents;s++)r=t.current.add_agent(n.payload.residence);n.payload.callback&&r&&n.payload.callback(r.agent_object)}if("map_agents"==n.type)return t.current.agents.map((function(e,t){return n.payload.callback(e,t)}));if("forEach_agents"==n.type&&t.current.agents.forEach((function(e){return n.payload.callback(e)})),"map_locations"==n.type)return t.current.locations.map((function(e,t){return n.payload.callback(e,t)}));if("forEach_location"==n.type&&t.current.locations.forEach((function(e){return n.payload.callback(e)})),"infect_random_agents"==n.type&&n.payload.num_agents)for(var c=0;c<n.payload.num_agents;c++){var _=ne.a.Common.choose(t.current.agents);t.current.expose_org(_.body,M.INFECTED)}if("get_migration_links"==n.type)return t.current.get_migration_links();if("add_migration_link"==n.type&&t.current.add_migration_link(n.payload.from_location,n.payload.to_location,n.payload.num_agents),"clear_migration_links"==n.type&&t.current.migration_graph.clear(),"remove_migration_link"==n.type&&t.current.remove_migration_link(n.payload.from_location,n.payload.to_location),"get_state_counts"==n.type)return{state_counts:t.current.state_counts,cur_time:t.current.cur_sim_time/t.current.simulation_params.sim_time_per_day};if("set_num_mask"==n.type){var u=[],l=[];t.current.agents.forEach((function(e){e.masked?u.push(e):l.push(e)}));var m=u.length,d=n.payload.num_masked-m;if(d>0)for(var p=0;p<d;p++)l[p].masked=!0;else if(d<0)for(var f=0;f<-d;f++)u[f].masked=!1}if("set_pop_size"==n.type){var h=n.payload.pop_size-t.current.agents.length;if(h>0)for(var g=0;g<h;g++)e(t,{type:"add_random_agent"});else if(h<0)for(var y=0;y<-h;y++)e(t,{type:"remove_random_agent"})}},ue=function(e){var t=ce(),n=Object(a.useRef)(null),i=Object(a.useState)(0),r=Object(s.a)(i,2),u=r[0],m=(r[1],Object(a.useState)(500)),d=Object(s.a)(m,2),p=d[0],f=d[1],h=Object(a.useState)(.05),g=Object(s.a)(h,2),y=g[0],v=(g[1],Object(a.useState)(.5)),k=Object(s.a)(v,2),E=k[0],j=(k[1],Object(a.useState)(2)),C=Object(s.a)(j,2),O=C[0],x=C[1],w=Object(a.useState)(.5),I=Object(s.a)(w,2),S=I[0],A=I[1],M=Object(a.useState)(5),R=Object(s.a)(M,2),B=R[0],L=R[1],N=Object(a.useState)(0),D=Object(s.a)(N,2),z=D[0],P=D[1],T=Object(a.useState)(0),q=Object(s.a)(T,2),F=q[0],W=q[1];return Object(a.useEffect)((function(){_e(n,{type:"update_infection_params",payload:{per_contact_infection:S}})}),[S]),Object(a.useEffect)((function(){_e(n,{type:"update_infection_params",payload:{infectious_period_mu:B}})}),[B]),Object(a.useEffect)((function(){_e(n,{type:"update_mask_transmission_params",payload:{self_protection:y}})}),[y]),Object(a.useEffect)((function(){_e(n,{type:"update_mask_transmission_params",payload:{others_protection:E}})}),[E]),Object(a.useEffect)((function(){_e(n,{type:"update_movement_scale",payload:{movement_scale:O}})}),[O]),Object(a.useEffect)((function(){_e(n,{type:"set_num_mask",payload:{num_masked:u}})}),[u]),Object(a.useEffect)((function(){_e(n,{type:"set_pop_size",payload:{pop_size:p}}),W((function(e){return e+1}))}),[p]),o.a.createElement("div",{className:"App"},o.a.createElement(_.a,{container:!0,direction:"row",justify:"center",className:t.root,spacing:3},o.a.createElement(_.a,{item:!0},o.a.createElement(l.a,{className:t.paper},o.a.createElement(ee,{InfectiousMatterRef:n,InfectiousMatterAPI:_e,redraw_trigger:z}))),o.a.createElement(_.a,{item:!0},o.a.createElement(l.a,{className:t.paper},o.a.createElement(b,{InfectiousMatterRef:n,InfectiousMatterAPI:_e,redraw_trigger:z,setWorldReadyTrigger:W,numMasked:u,popSize:p}))),o.a.createElement(_.a,{item:!0},o.a.createElement(l.a,{className:t.paper},o.a.createElement(J,{InfectiousMatterRef:n,InfectiousMatterAPI:_e,worldReadyTrigger:F})))),o.a.createElement(_.a,{container:!0,direction:"row",justify:"center",className:t.root,spacing:10},o.a.createElement(_.a,{item:!0,alignItems:"flex-start"},o.a.createElement(l.a,{className:t.paperControlls},o.a.createElement(oe.a,null,o.a.createElement(se.a,{disableSticky:!0},"World Settings"),o.a.createElement(ie.a,null,o.a.createElement(re.a,{id:"PopSize",primary:"Pop Size"}),o.a.createElement(ae.a,{value:p,"aria-labelledby":"discrete-slider",valueLabelDisplay:"on",onChange:function(e,t){f(t)},step:1,min:0,max:800})),o.a.createElement(ie.a,null,o.a.createElement(re.a,{id:"Movement",primary:"Movement Scale"}),o.a.createElement(ae.a,{value:O,"aria-labelledby":"discrete-slider",valueLabelDisplay:"on",onChange:function(e,t){x(t)},step:.25,min:0,max:10})),o.a.createElement(ie.a,null,o.a.createElement(_.a,{container:!0,direction:"row",spacing:3},o.a.createElement(_.a,{item:!0},o.a.createElement(c.a,{variant:"contained",onClick:function(e){_e(n,{type:"reset_simulator"}),P((function(e){return e+1}))}},"Reset")),o.a.createElement(_.a,{item:!0},o.a.createElement(c.a,{variant:"contained",onClick:function(e){_e(n,{type:"infect_random_agents",payload:{num_agents:1}})}},"Infect Random Agent")))),o.a.createElement(se.a,{disableSticky:!0},"Infection Settings"),o.a.createElement(ie.a,null,o.a.createElement(re.a,{id:"infectionRate",primary:"Prob. Infection"}),o.a.createElement(ae.a,{value:S,"aria-labelledby":"continuous-slider",onChange:function(e,t){A(t)},valueLabelDisplay:"on",min:0,max:1,step:.01})),o.a.createElement(ie.a,null,o.a.createElement(re.a,{id:"infectiousPeriod",primary:"Mean Infectious Days"}),o.a.createElement(ae.a,{value:B,"aria-labelledby":"continuous-slider",onChange:function(e,t){L(t)},valueLabelDisplay:"on",min:3,max:12,step:.1})))))))};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ue,null)),document.getElementById("root"))}},[[501,1,2]]]);
//# sourceMappingURL=main.2ac617b9.chunk.js.map