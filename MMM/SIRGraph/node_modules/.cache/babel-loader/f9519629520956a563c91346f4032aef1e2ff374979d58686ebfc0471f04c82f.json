{"ast":null,"code":"var FastPriorityQueue=require('fastpriorityqueue');var assert=require('assert');function EventQueue(){this.fast_queue=new FastPriorityQueue(function(a,b){return a.time<=b.time;});};EventQueue.prototype.add_event=function(cur_sim_time,q_event){assert(q_event.time&&q_event.callback);q_event.original_time=q_event.time;q_event.time+=cur_sim_time;q_event.stale=false;this.fast_queue.add(q_event);};EventQueue.prototype.run_events_fired=function(cur_sim_time,event_limit){var num_events=0;while(this.fast_queue.peek()&&this.fast_queue.peek().time<cur_sim_time&&num_events<event_limit){var this_event=this.fast_queue.poll();if(this_event.stale==false){if(this_event.recurring){this.add_event(cur_sim_time,{time:this_event.original_time,callback:this_event.callback,recurring:true,stale:false});}this_event.callback();num_events+=1;}}};EventQueue.prototype.clear_events=function(){this.fast_queue=null;this.fast_queue=new FastPriorityQueue(function(a,b){return a.time<=b.time;});};module.exports={EventQueue:EventQueue};","map":{"version":3,"names":["FastPriorityQueue","require","assert","EventQueue","fast_queue","a","b","time","prototype","add_event","cur_sim_time","q_event","callback","original_time","stale","add","run_events_fired","event_limit","num_events","peek","this_event","poll","recurring","clear_events","module","exports"],"sources":["/Users/zamanlh/github/MMM_Worksheets/networksir/src/event_queue.js"],"sourcesContent":["let FastPriorityQueue = require('fastpriorityqueue');\nlet assert = require('assert');\n\n\nfunction EventQueue() {\n\tthis.fast_queue = new FastPriorityQueue(function(a,b) {\n\t\treturn a.time <= b.time;\n\t});\n};\n\nEventQueue.prototype.add_event = function(cur_sim_time, q_event) {\n\tassert(q_event.time && q_event.callback);\n\tq_event.original_time = q_event.time;\n\tq_event.time += cur_sim_time;\n\tq_event.stale = false;\n\tthis.fast_queue.add(q_event);\n};\n\nEventQueue.prototype.run_events_fired = function(cur_sim_time, event_limit) {\n\tlet num_events = 0;\n\twhile (this.fast_queue.peek() && this.fast_queue.peek().time < cur_sim_time && num_events < event_limit){\n\t\tvar this_event = this.fast_queue.poll();\n\n\t\tif (this_event.stale == false) {\n\t\t\tif (this_event.recurring) {\n\t\t\t\tthis.add_event(cur_sim_time, {time:this_event.original_time, callback:this_event.callback, recurring:true, stale:false});\n\t\t\t}\n\t\t\tthis_event.callback();\n\t\t\tnum_events += 1;\n\t\t}\n\t}\n};\n\nEventQueue.prototype.clear_events = function() {\n\tthis.fast_queue = null;\n\tthis.fast_queue = new FastPriorityQueue(function(a,b) {\n\t\treturn a.time <= b.time;\n\t});\n};\n\n\n\nmodule.exports = {EventQueue};"],"mappings":"AAAA,GAAI,CAAAA,iBAAiB,CAAGC,OAAO,CAAC,mBAAmB,CAAC,CACpD,GAAI,CAAAC,MAAM,CAAGD,OAAO,CAAC,QAAQ,CAAC,CAG9B,QAAS,CAAAE,UAAUA,CAAA,CAAG,CACrB,IAAI,CAACC,UAAU,CAAG,GAAI,CAAAJ,iBAAiB,CAAC,SAASK,CAAC,CAACC,CAAC,CAAE,CACrD,MAAO,CAAAD,CAAC,CAACE,IAAI,EAAID,CAAC,CAACC,IAAI,CACxB,CAAC,CAAC,CACH,CAAC,CAEDJ,UAAU,CAACK,SAAS,CAACC,SAAS,CAAG,SAASC,YAAY,CAAEC,OAAO,CAAE,CAChET,MAAM,CAACS,OAAO,CAACJ,IAAI,EAAII,OAAO,CAACC,QAAQ,CAAC,CACxCD,OAAO,CAACE,aAAa,CAAGF,OAAO,CAACJ,IAAI,CACpCI,OAAO,CAACJ,IAAI,EAAIG,YAAY,CAC5BC,OAAO,CAACG,KAAK,CAAG,KAAK,CACrB,IAAI,CAACV,UAAU,CAACW,GAAG,CAACJ,OAAO,CAAC,CAC7B,CAAC,CAEDR,UAAU,CAACK,SAAS,CAACQ,gBAAgB,CAAG,SAASN,YAAY,CAAEO,WAAW,CAAE,CAC3E,GAAI,CAAAC,UAAU,CAAG,CAAC,CAClB,MAAO,IAAI,CAACd,UAAU,CAACe,IAAI,EAAE,EAAI,IAAI,CAACf,UAAU,CAACe,IAAI,EAAE,CAACZ,IAAI,CAAGG,YAAY,EAAIQ,UAAU,CAAGD,WAAW,CAAC,CACvG,GAAI,CAAAG,UAAU,CAAG,IAAI,CAAChB,UAAU,CAACiB,IAAI,EAAE,CAEvC,GAAID,UAAU,CAACN,KAAK,EAAI,KAAK,CAAE,CAC9B,GAAIM,UAAU,CAACE,SAAS,CAAE,CACzB,IAAI,CAACb,SAAS,CAACC,YAAY,CAAE,CAACH,IAAI,CAACa,UAAU,CAACP,aAAa,CAAED,QAAQ,CAACQ,UAAU,CAACR,QAAQ,CAAEU,SAAS,CAAC,IAAI,CAAER,KAAK,CAAC,KAAK,CAAC,CAAC,CACzH,CACAM,UAAU,CAACR,QAAQ,EAAE,CACrBM,UAAU,EAAI,CAAC,CAChB,CACD,CACD,CAAC,CAEDf,UAAU,CAACK,SAAS,CAACe,YAAY,CAAG,UAAW,CAC9C,IAAI,CAACnB,UAAU,CAAG,IAAI,CACtB,IAAI,CAACA,UAAU,CAAG,GAAI,CAAAJ,iBAAiB,CAAC,SAASK,CAAC,CAACC,CAAC,CAAE,CACrD,MAAO,CAAAD,CAAC,CAACE,IAAI,EAAID,CAAC,CAACC,IAAI,CACxB,CAAC,CAAC,CACH,CAAC,CAIDiB,MAAM,CAACC,OAAO,CAAG,CAACtB,UAAU,CAAVA,UAAU,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}